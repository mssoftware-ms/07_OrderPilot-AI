# Crypto Mean Reversion Strategy
#
# Bollinger Bands basierte Mean Reversion Strategie
# Ideal für Crypto in Range-bound Markets
#
# Logik:
# - Long Entry: Preis berührt untere Bollinger Band + RSI oversold
# - Long Exit: Preis erreicht mittlere Bollinger Band (SMA)
# - Short Entry: Preis berührt obere Bollinger Band + RSI overbought
# - Short Exit: Preis erreicht mittlere Bollinger Band
#
# Empfohlene Assets: ETH/USD, BTC/USD (in Sideways Markets)
# Empfohlene Timeframes: 30min, 1H, 4H

name: "Crypto Mean Reversion (Bollinger Bands)"
version: "1.0.0"
category: "Mean Reversion"
author: "OrderPilot-AI"
description: |
  Bollinger Bands basierte Mean Reversion Strategie für Crypto.
  Kauft Oversold-Bedingungen und verkauft Overbought-Bedingungen.
  Am besten in Range-bound oder seitwärts gerichteten Märkten.

# Asset-Klasse
asset_class: crypto
recommended_symbols:
  - "BTC/USD"
  - "ETH/USD"
  - "MATIC/USD"
  - "SOL/USD"

# Zeitrahmen
recommended_timeframes:
  - "30min"
  - "1H"
  - "4H"
  - "1D"

# Indikatoren
indicators:
  # Bollinger Bands (20, 2.0)
  - type: BBANDS
    alias: bbands
    params:
      period: 20
      deviation: 2.0
    source: close
    plot: true

  # RSI für Oversold/Overbought
  - type: RSI
    alias: rsi
    params:
      period: 14
    source: close
    plot: true

  # SMA für mittlere Band-Referenz
  - type: SMA
    alias: sma_mid
    params:
      period: 20
    source: close
    plot: true

  # ATR für Volatility-Filter
  - type: ATR
    alias: atr
    params:
      period: 14
    plot: true

  # ADX für Regime Filter (Range Detection)
  - type: ADX
    alias: adx
    params:
      period: 14
    plot: true

# Entry Long: Preis berührt untere BB + RSI < 25 + ADX < 25
entry_long:
  type: composite
  operator: AND
  conditions:
    - type: condition
      left: close
      operator: "<="
      right: "bbands.lower"
      description: "Preis berührt oder unterschreitet untere Bollinger Band"

    - type: condition
      left: rsi
      operator: "<"
      right: 25
      description: "RSI zeigt Oversold (< 25) - Stricter"

    # Regime Filter: Range Market Only
    - type: condition
      left: adx
      operator: "<"
      right: 25
      description: "Market in Range (ADX < 25)"

    # Volatility Filter: Nur Entry wenn ATR hoch genug ist
    - type: condition
      left: atr
      operator: ">"
      right_formula: "sma_mid * 0.015"
      description: "Volatilität ist ausreichend (ATR > 1.5% von SMA)"

# Exit Long: Preis erreicht mittlere BB
exit_long:
  type: composite
  operator: OR
  conditions:
    # Take Profit: Mittlere Band erreicht
    - type: condition
      left: close
      operator: ">="
      right: "bbands.middle"
      description: "Preis erreicht mittlere Bollinger Band (Mean Reversion vollzogen)"

    # Stop Loss: Preis fällt weiter unter untere Band
    - type: condition
      left: close
      operator: "<"
      right_formula: "bbands.lower * 0.98"
      description: "Stop Loss: Preis fällt 2% unter untere Band"

# Entry Short: Preis berührt obere BB + RSI > 70
entry_short:
  type: composite
  operator: AND
  conditions:
    - type: condition
      left: close
      operator: ">="
      right: "bbands.upper"
      description: "Preis berührt oder überschreitet obere Bollinger Band"

    - type: condition
      left: rsi
      operator: ">"
      right: 70
      description: "RSI zeigt Overbought (> 70)"

    # Volatility Filter
    - type: condition
      left: atr
      operator: ">"
      right_formula: "sma_mid * 0.015"
      description: "Volatilität ist ausreichend"

# Exit Short: Preis erreicht mittlere BB
exit_short:
  type: composite
  operator: OR
  conditions:
    # Take Profit: Mittlere Band erreicht
    - type: condition
      left: close
      operator: "<="
      right: "bbands.middle"
      description: "Preis erreicht mittlere Bollinger Band"

    # Stop Loss: Preis steigt weiter über obere Band
    - type: condition
      left: close
      operator: ">"
      right_formula: "bbands.upper * 1.02"
      description: "Stop Loss: Preis steigt 2% über obere Band"

# Risk Management
risk_management:
  # Stop Loss: 2.5%
  stop_loss_pct: 2.5

  # Take Profit: 5% (2:1 R/R)
  take_profit_pct: 5.0

  # Position Size: 15% des Kapitals (da Mean Reversion oft hohe Win-Rate hat)
  position_size_pct: 15.0

  # Max Trades per Day (to avoid overtrading in wrong regime)
  max_trades_per_day: 5

  # Trailing Stop deaktiviert (Mean Reversion hat definierte Ziele)
  trailing_stop_enabled: false

# Backtest-Parameter
backtest:
  initial_capital: 10000
  commission: 0.001  # 0.1%
  slippage: 0.0005

# Hinweise
notes: |
  **Mean Reversion Strategie für Crypto:**

  Diese Strategie funktioniert am besten in seitwärts gerichteten Märkten
  (Range-bound Markets), wo Preise zwischen oberen und unteren Bändern oszillieren.

  **Vorteile:**
  - Hohe Win-Rate in Sideways Markets
  - Klare Entry/Exit-Signale durch Bollinger Bands
  - RSI-Filter reduziert False Signals

  **Nachteile:**
  - Funktioniert NICHT gut in stark trendenden Märkten
  - Kann zu frühzeitigen Entries führen (Preis kann weiter fallen/steigen)
  - Crypto kann länger in extremen Bereichen bleiben als Stocks

  **Wann NICHT verwenden:**
  - In starken Trends (Up oder Down)
  - Bei Breaking News / Major Events
  - Wenn Bollinger Bands sich stark erweitern (hohe Volatilität)

  **Optimierungsvorschläge:**
  - BB Period: 15-30 (Standard: 20)
  - BB Deviation: 1.5-2.5 (Standard: 2.0)
  - RSI Oversold: 20-35 (Standard: 30)
  - RSI Overbought: 65-80 (Standard: 70)
  - ATR Filter: 1.0%-2.0% (Standard: 1.5%)

  **Empfohlene Asset-Auswahl:**
  - Assets mit klaren Support/Resistance-Leveln
  - Mittlere bis hohe Liquidität (BTC, ETH bevorzugt)
  - Assets in Konsolidierungsphasen
