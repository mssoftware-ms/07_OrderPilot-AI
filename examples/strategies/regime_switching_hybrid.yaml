# Regime Switching Hybrid Strategy
#
# Meta-strategy that switches between sub-strategies based on Market Regime.
#
# Regimes:
# 1. Trend: ADX > 25 -> Use Trend Follow / Momentum
# 2. Range (Chop): ADX < 20 & Bandwidth low -> Use Mean Reversion
# 3. Volatile/Transition: ATR High -> Use Breakout
#
# Logic:
# - Checks regime indicators first.
# - Activates specific logic blocks.

name: "Regime Switching Hybrid"
version: "1.0.0"
category: "Hybrid"
author: "OrderPilot-AI"
description: |
  Adapts to market conditions.
  Trend Regime: Uses EMA/MACD logic.
  Range Regime: Uses Bollinger/RSI logic.

asset_class: crypto
recommended_symbols: ["BTC/USD", "ETH/USD"]
recommended_timeframes: ["5m", "15m"]

indicators:
  - type: ADX
    alias: adx
    params: { period: 14 }
    plot: true

  - type: ATR
    alias: atr
    params: { period: 14 }
    plot: true

  - type: BBANDS
    alias: bbands
    params: { period: 20, deviation: 2.0 }
    plot: true

  - type: RSI
    alias: rsi
    params: { period: 14 }
    plot: true

  - type: EMA
    alias: ema_trend
    params: { period: 50 }
    plot: true

# Complex Entry Logic using "OR" for different regimes
entry_long:
  type: group
  operator: OR
  conditions:
    # REGIME 1: TREND (ADX > 25)
    - type: group
      operator: AND
      description: "Trend Regime Long"
      conditions:
        - type: condition
          left: adx
          operator: ">"
          right: 25
          description: "Strong Trend"
        - type: condition
          left: close
          operator: ">"
          right: ema_trend
          description: "Above Trend EMA"
        - type: condition
          left: rsi
          operator: "<"
          right: 60
          description: "Not Overbought (Room to grow)"

    # REGIME 2: RANGE (ADX < 20)
    - type: group
      operator: AND
      description: "Range Regime Long (Mean Reversion)"
      conditions:
        - type: condition
          left: adx
          operator: "<"
          right: 20
          description: "Weak Trend (Range)"
        - type: condition
          left: close
          operator: "<="
          right: "bbands.lower"
          description: "At Lower Band"
        - type: condition
          left: rsi
          operator: "<"
          right: 30
          description: "Oversold"

exit_long:
  type: group
  operator: OR
  conditions:
    # Trend Exit
    - type: group
      operator: AND
      conditions:
        - type: condition
          left: adx
          operator: ">"
          right: 25
        - type: condition
          left: close
          operator: "<"
          right: ema_trend

    # Range Exit
    - type: group
      operator: AND
      conditions:
        - type: condition
          left: adx
          operator: "<"
          right: 20
        - type: condition
          left: close
          operator: ">="
          right: "bbands.middle"

risk_management:
  stop_loss_atr_multiplier: 2.0
  take_profit_atr_multiplier: 3.0
  trailing_stop_enabled: true
  trailing_stop_trigger_pct: 1.0

backtest:
  initial_capital: 10000
