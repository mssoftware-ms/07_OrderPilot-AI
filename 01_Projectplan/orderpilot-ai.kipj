Die "§" unter "# Anweisungen an die KI" sind dringend zu befolgen und handele danach, merke dir diese Punkte für den ganzen chat!

Dateityp = Markdown (.md)

# Projekttitel: OrderPilot-AI
Erstellt am: 2025-12-16 10:47:30
Analyse Methode: Kommentare im Code.

## Verwendete Dateien:
- Hauptdatei: D:\03_Git\02_Python\07_OrderPilot-AI\main.py
- /src/__init__.py
- /src/ai/__init__.py
- /src/ai/ai_provider_factory.py
- /src/ai/anthropic_service.py
- /src/ai/gemini_service.py
- /src/ai/openai_service.py
- /src/ai/prompts.py
- /src/common/__init__.py
- /src/common/event_bus.py
- /src/common/logging_setup.py
- /src/common/security_core.py
- /src/config/__init__.py
- /src/config/loader.py
- /src/core/__init__.py
- /src/core/backtesting/__init__.py
- /src/core/backtesting/backtrader_integration.py
- /src/core/backtesting/optimization.py
- /src/core/backtesting/result_converter.py
- /src/core/broker/__init__.py
- /src/core/broker/base.py
- /src/core/broker/ibkr_adapter.py
- /src/core/broker/mock_broker.py
- /src/core/broker/trade_republic_adapter.py
- /src/core/execution/__init__.py
- /src/core/execution/events.py
- /src/core/indicators/__init__.py
- /src/core/indicators/base.py
- /src/core/indicators/custom.py
- /src/core/indicators/engine.py
- /src/core/indicators/momentum.py
- /src/core/indicators/trend.py
- /src/core/indicators/types.py
- /src/core/indicators/volatility.py
- /src/core/indicators/volume.py
- /src/core/market_data/__init__.py
- /src/core/market_data/alpaca_crypto_provider.py
- /src/core/market_data/alpaca_crypto_stream.py
- /src/core/market_data/alpaca_stream.py
- /src/core/market_data/alpha_vantage_stream.py
- /src/core/market_data/history_provider.py
- /src/core/market_data/providers/__init__.py
- /src/core/market_data/providers/alpaca_stock_provider.py
- /src/core/market_data/providers/alpha_vantage_provider.py
- /src/core/market_data/providers/base.py
- /src/core/market_data/providers/database_provider.py
- /src/core/market_data/providers/finnhub_provider.py
- /src/core/market_data/providers/ibkr_provider.py
- /src/core/market_data/providers/yahoo_provider.py
- /src/core/market_data/stream_client.py
- /src/core/market_data/types.py
- /src/core/models/__init__.py
- /src/core/models/backtest_models.py
- /src/core/strategy/__init__.py
- /src/core/strategy/compiled_strategy.py
- /src/core/strategy/compiler.py
- /src/core/strategy/definition.py
- /src/core/strategy/engine.py
- /src/core/strategy/evaluation.py
- /src/core/strategy/loader.py
- /src/core/strategy/strategies/__init__.py
- /src/core/strategy/strategies/breakout.py
- /src/core/strategy/strategies/mean_reversion.py
- /src/core/strategy/strategies/momentum.py
- /src/core/strategy/strategies/scalping.py
- /src/core/strategy/strategies/trend_following.py
- /src/database/__init__.py
- /src/database/database.py
- /src/database/models.py
- /src/ui/__init__.py
- /src/ui/app.py
- /src/ui/app_components/__init__.py
- /src/ui/app_components/broker_mixin.py
- /src/ui/app_components/menu_mixin.py
- /src/ui/app_components/toolbar_mixin.py
- /src/ui/chart/__init__.py
- /src/ui/chart/chart_adapter.py
- /src/ui/chart/chart_bridge.py
- /src/ui/chart_window_manager.py
- /src/ui/dialogs/__init__.py
- /src/ui/dialogs/ai_backtest_dialog.py
- /src/ui/dialogs/backtest_dialog.py
- /src/ui/dialogs/order_dialog.py
- /src/ui/dialogs/parameter_optimization_dialog.py
- /src/ui/dialogs/settings_dialog.py
- /src/ui/icons.py
- /src/ui/themes.py
- /src/ui/widgets/__init__.py
- /src/ui/widgets/alerts.py
- /src/ui/widgets/backtest_chart_widget.py
- /src/ui/widgets/chart_mixins/__init__.py
- /src/ui/widgets/chart_mixins/data_loading_mixin.py
- /src/ui/widgets/chart_mixins/indicator_mixin.py
- /src/ui/widgets/chart_mixins/state_mixin.py
- /src/ui/widgets/chart_mixins/streaming_mixin.py
- /src/ui/widgets/chart_mixins/toolbar_mixin.py
- /src/ui/widgets/chart_window.py
- /src/ui/widgets/chart_window_mixins/__init__.py
- /src/ui/widgets/chart_window_mixins/backtest_mixin.py
- /src/ui/widgets/chart_window_mixins/event_bus_mixin.py
- /src/ui/widgets/chart_window_mixins/panels_mixin.py
- /src/ui/widgets/chart_window_mixins/state_mixin.py
- /src/ui/widgets/dashboard.py
- /src/ui/widgets/embedded_tradingview_chart.py
- /src/ui/widgets/indicators.py
- /src/ui/widgets/orders.py
- /src/ui/widgets/performance_dashboard.py
- /src/ui/widgets/positions.py
- /src/ui/widgets/watchlist.py
- /src/ui/widgets/widget_helpers.py
- /start_orderpilot.py
- /requirements.txt

# Projektstatistik
<!--STATS
{
    "total_files": 112,
    "num_py_files": 111,
    "num_other_files": 1,
    "total_classes": 200,
    "total_functions": 52,
    "total_lines": 31490,
    "token_count": 231161
}
-->
<!-- STATS -->

# Projektbeschreibung
Das Programm ist eine umfassende Trading- und Analyseplattform mit folgenden Kernfunktionen:

1. **Unified AI Services**  
   Es unterstützt mehrere AI-Service-Provider wie OpenAI, Anthropic und Google Gemini. Über eine Factory (`AIProviderFactory`) werden basierend auf den Nutzer-Einstellungen passende AI-Services instanziiert. Diese Services bieten strukturierte AI-Analysen wie Orderanalyse, Alert-Triage, Backtest-Reviews und Trade-Analyse mit validierten, schema-konformen Antworten. Die AI-Funktionalitäten beinhalten zudem Kosten- und Budgetkontrolle sowie Caching zur Optimierung der Nutzung.

2. **Marktdatenverwaltung**  
   Historische und Echtzeit-Marktdaten werden über diverse Provider bereitgestellt (z.B. Alpaca, Alpha Vantage, Finnhub, IBKR, Yahoo Finance). Ein `HistoryManager` koordiniert den Zugriff mit Fallbacks. Für Kryptowährungen gibt es spezialisierte Streaming-Clients mit WebSocket-Unterstützung. Diese Daten werden für Chartdarstellung, Backtesting und Indikatorberechnung genutzt.

3. **Technische Indikatoren und Strategien**  
   Das System berechnet umfassend technische Indikatoren (Trend, Momentum, Volatilität, Volumen, Custom-Indikatoren) über konfigurierbare Engines. Es unterstützt deklarative Strategie-Definitionen (über YAML/JSON), die zur Laufzeit kompiliert und als Backtrader-Strategien ausgeführt werden. So können komplexe Entry-/Exit-Logiken und Risiko-Management-Regeln realisiert werden.

4. **Backtesting & Optimierung**  
   Backtests werden mit historischen Daten (Backtrader-Integration) durchgeführt und liefern umfangreiche Performance- und Trade-Metriken. Das System stellt umfassende Reports, Chartvisualisierungen und AI-basierte Analysen zur Verfügung. Zusätzlich ermöglicht eine Optimierungs-Engine die automatische Parametertests und iterative Verbesserung dank AI-Assistenz.

5. **Broker-Anbindung & Ordermanagement**  
   Es gibt modulare Broker-Adapter (z.B. IBKR, Trade Republic, Mock Broker) mit Template-Methoden zur Verbindung, Orderausführung, Statusabfrage, Positions- und Kontoverwaltung. Sicherheitsmechanismen wie Rate Limiting und Kill-Switch sind integriert. Orderplatzierungen können vorab mittels AI analysiert werden.

6. **Benutzeroberfläche & Visualisierung**  
   Die Oberfläche nutzt Qt (PyQt6) mit Tabs, Dock-Widgets und modernen Chart-Komponenten (TradingView Lightweight Charts eingebettet). Sie bietet interaktive Chartfenster, Backtest-Visualisierungen, Watchlists, Portfoliodashboards, Alerts und Orders-Übersichten. Die Kommunikation zwischen Python und JavaScript erfolgt bidirektional über Qt WebChannel.

7. **Ereignisverwaltung & Logging**  
   Ein zentraler Event-Bus managt interne Ereignisse (Orders, Trades, Alerts) für UI-Updates und Logiksteuerung. Logging ist umfassend mit JSON-Format, Audit- und Security-Logs sowie speziellen Filtern für AI-Telemetriedaten.

8. **Konfiguration & Sicherheit**  
   Profile und Einstellungen werden flexibel verwaltet. Sicherheit wird durch API-Key-Management, Passwort-Hashing, Eingabe-Sanitierung und Berechtigungslevel gewährleistet. Rate Limiting schützt vor API-Überlastung.

---

Diese modulare Architektur ermöglicht eine leistungsstarke Kombination aus Datenanalyse, automatisiertem Trading und AI-gestützter Entscheidungsunterstützung in einem modernen, erweiterbaren Framework.

# Bekannte Probleme

# To-Do Liste
Keine offenen Aufgaben.

# Anweisungen an die KI
# System-Prompt: KI für Sichere Python-Code-Bearbeitung

## Rolle  
Du bist eine erfahrene KI-Code-Editorin, die Python-Code **ausschließlich nach expliziter Anweisung ändert** und dabei **keinen nicht betroffenen Code auch nur minimal verändert oder löscht**.  

- Du befolgst die Vorgaben der Benutzerin oder des Benutzers **streng und wortwörtlich**, bearbeitest nur die exakt genannten Funktionen, Methoden oder Codestellen.  
- Alle anderen Funktionen, Klassen und Codeabschnitte bleiben **bytegleich unverändert**, inklusive Formatierung, Leerzeichen und Kommentaren.  
- Du bleibst solange aktiv und arbeitest iterativ weiter, bis die Aufgabe vollständig erledigt und geprüft ist. Du beendest deinen Arbeitsvorgang erst, wenn du dir absolut sicher bist, dass die Lösung komplett und korrekt ist.  

§1 Als allererste Reaktion auf jeden Punkt fordere von mir aktiv die Datei(en) an, in denen der betroffene Code am wahrscheinlichsten enthalten ist. Falls du unsicher bist, überlasse die Auswahl mir.
§2 Erstelle niemals neuen oder angepassten Code, bevor ich dir den Inhalt der betreffenden Dateien zur Verfügung gestellt habe.
§3 Merke dir alle bekannten Probleme und Aufgaben für den weiteren Verlauf der Zusammenarbeit.
## Arbeitsablauf  

1. **Anforderung analysieren:**  
   - Prüfe genau, welche Datei(en) und welche Funktion(en) oder Codeteile bearbeitet werden sollen.  
   - Falls nicht explizit genannt, frage nach oder prüfe den Kontext genau, bevor du Änderungen vornimmst.  

2. **Kontext beschaffen:**  
   - Falls der zu bearbeitende Code nicht im Chat ist oder du unsicher bist, hole dir den aktuellen Quellcode per Tool (z.B. `open_file`) ab.  
   - Verlasse dich niemals auf Vermutungen oder Halluzinationen, sondern verwende immer den tatsächlichen Quellcode.  

3. **Planung:**  
   - Erstelle vor dem Ändern einen klaren Plan, welche Änderungen in der benannten Funktion oder Codestelle notwendig sind.  
   - Überlege, wie sich die Änderungen auf den Rest des Codes auswirken könnten (ohne dort etwas zu verändern).  
   - Zerlege komplexe Änderungen in kleine Schritte und notiere dir diese intern.  

4. **Werkzeuge nutzen:**  
   - Teile deine geplanten Schritte mit der Benutzerin/dem Benutzer, bevor du Tools aufrufst (z.B. “Ich werde jetzt den Patch anwenden.”).  
   - Nutze Tools wie  `run_tests` zur Verifikation.  
   - Nach Ausführung eines Tools gib eine kurze Statusmeldung (“Patch erfolgreich angewandt.” oder “Tests laufen…”).  

5. **Gezielte Änderungen umsetzen:**  
   - Ändere **ausschließlich** die explizit benannten Methoden oder Codeteile.  
   - Unveränderte Teile der Datei müssen **bytegenau identisch** bleiben (einschließlich Leerzeilen, Einrückungen und Kommentare).  
   - Erstelle Patches mit jeweils ca. 3 Zeilen Kontext um jede Änderung herum.  
   - Vermeide unnötige Änderungen, auch keine Änderung von Leerzeichen oder Zeilenenden außerhalb des Bereichs.  

6. **Testen und Verifizieren:**  
   - Führe nach dem Patch alle verfügbaren Tests aus, um sicherzustellen, dass die Änderung wirkt und keine Fehler verursacht.  
   - Falls Fehler auftreten, analysiere diese, passe den Patch an und teste erneut.  
   - Iteriere solange, bis alle Tests bestanden sind und die Änderung erfolgreich ist.  

7. **Abschließende Prüfung:**  
   - Vergleiche Datei vor und nach deiner Änderung vollständig.  
   - Bestätige, dass alle **nicht zu ändernden Funktionen, Klassen und Codeabschnitte exakt gleich geblieben sind** (bytegleich).  
   - Falls eine Abweichung außerhalb des gewünschten Bereichs vorliegt, korrigiere den Patch oder breche ab und informiere die Benutzerin/den Benutzer.  

## Validierung  

- **Unveränderte Teile müssen unverändert bleiben!** Jegliche unbeabsichtigte Änderung führt zum Abbruch oder zu einer Warnung.  
- Wenn du unerwartete Änderungen findest, liefere keinen Patch ohne Hinweis, sondern informiere deutlich über das Problem.  
- Nur wenn du sicher bist, dass alles passt, gib den Patch frei.  
- Alle Tests müssen idealerweise fehlerfrei durchlaufen.  

## Ausgabeformat  

- Gib als finale Ausgabe die ganze Datei aus.

---

Nutze diese Anweisungen für alle Python-Code-Bearbeitungen, um maximale Sicherheit und Präzision zu gewährleisten.

# Projektbaum
<!--TREE 
- main.py
  - __init__.py
  - __init__.py
    - def get_ai_service(.)
      - Kommentar: Get AI service instance based on settings (OpenAI or Anthropic).
      - 
      - Uses AIProviderFactory to create the appropriate service based on
      - user settings in QSettings.
      - 
      - Args:
      -     telemetry_callback: Optional callback for telemetry
      - 
      - Returns:
      -     AI service instance (OpenAIService or AnthropicService)
      - 
      - Raises:
      -     ValueError: If AI is disabled or not configured
    - def reset_ai_service(.)
      - Kommentar: Reset the AI service instance (e.g., when settings change).
    - Kommentar: ==================== Unified AI Service Getter ====================
    - Kommentar: Services
    - Kommentar: NEW: Unified multi-provider getter
    - Kommentar: Errors
    - Kommentar: Response Models
    - Kommentar: Components
    - Kommentar: Prompts
  - ai_provider_factory.py
    - Class: AIProviderFactory
      - Kommentar: Factory for creating AI service instances based on configuration.
      - def get_provider(.)
        - Kommentar: Get the configured AI provider from QSettings.
        - 
        - Returns:
        -     Provider name: "OpenAI" or "Anthropic"
      - def is_ai_enabled(.)
        - Kommentar: Check if AI features are enabled.
        - 
        - Returns:
        -     True if AI is enabled, False otherwise
      - def get_api_key(.)
        - Kommentar: Get API key for the specified provider.
        - 
        - Args:
        -     provider: Provider name ("OpenAI" or "Anthropic")
        - 
        - Returns:
        -     API key from environment or keyring, None if not found
      - def get_model(.)
        - Kommentar: Get the configured model for the provider.
        - 
        - Args:
        -     provider: Provider name ("OpenAI" or "Anthropic")
        - 
        - Returns:
        -     Model name/ID
      - def create_service(.)
        - Kommentar: Create an AI service instance based on current settings.
        - 
        - Args:
        -     telemetry_callback: Optional callback for telemetry
        - 
        - Returns:
        -     AI service instance (OpenAIService or AnthropicService)
        - 
        - Raises:
        -     ValueError: If AI is disabled or API key is missing
      - def get_monthly_budget(.)
        - Kommentar: Get the configured monthly AI budget.
        - 
        - Returns:
        -     Monthly budget in EUR
  - anthropic_service.py
    - Class: AnthropicService
      - Kommentar: Main Anthropic service for structured outputs.
      - 
      - Mirrors OpenAIService structure for drop-in compatibility.
      - def __init__(.)
        - Kommentar: Initialize Anthropic service.
        - 
        - Args:
        -     config: AI configuration
        -     api_key: Anthropic API key
        -     telemetry_callback: Optional callback for telemetry
      - def __aenter__(.)
        - Kommentar: Async context manager entry.
      - def __aexit__(.)
        - Kommentar: Async context manager exit.
      - def initialize(.)
        - Kommentar: Initialize the service.
      - def close(.)
        - Kommentar: Close the service.
      - def structured_completion(.)
        - Kommentar: Get structured completion from Anthropic Claude.
        - 
        - Args:
        -     prompt: The prompt to send
        -     response_model: Pydantic model for response validation
        -     model: Model to use (defaults to self.default_model)
        -     temperature: Temperature for generation (0.0-1.0)
        -     use_cache: Whether to use caching
        -     context: Additional context for the request
        - 
        - Returns:
        -     Validated response as Pydantic model instance
        - 
        - Raises:
        -     RateLimitError: If rate limited by API
        -     QuotaExceededError: If monthly budget exceeded
        -     SchemaValidationError: If response doesn't match schema
      - def analyze_order(.)
        - Kommentar: Analyze an order for risk and approval.
        - 
        - Args:
        -     order_data: Order details
        - 
        - Returns:
        -     OrderAnalysis with approval recommendation
      - def triage_alert(.)
        - Kommentar: Triage an alert to determine priority and actions.
        - 
        - Args:
        -     alert_data: Alert details
        - 
        - Returns:
        -     AlertTriageResult with priority and suggested actions
      - def review_backtest(.)
        - Kommentar: Review backtest results and provide insights.
        - 
        - Args:
        -     backtest_data: Backtest results and metrics
        - 
        - Returns:
        -     BacktestReview with insights and recommendations
      - def get_cost_summary(.)
        - Kommentar: Get cost tracking summary.
        - 
        - Returns:
        -     Dictionary with cost stats
      - def reset_costs(.)
        - Kommentar: Reset cost tracking (e.g., at start of new month).
      - def clear_cache(.)
        - Kommentar: Clear the response cache.
    - Kommentar: Import shared models from OpenAI service
    - Kommentar: Reuse as AnthropicError
  - gemini_service.py
    - Class: GeminiService
      - Kommentar: Main Gemini service for structured outputs.
      - 
      - Mirrors OpenAIService/AnthropicService structure for drop-in compatibility.
      - def __init__(.)
        - Kommentar: Initialize Gemini service.
        - 
        - Args:
        -     config: AI configuration
        -     api_key: Gemini API key
        -     telemetry_callback: Optional callback for telemetry
      - def __aenter__(.)
        - Kommentar: Async context manager entry.
      - def __aexit__(.)
        - Kommentar: Async context manager exit.
      - def initialize(.)
        - Kommentar: Initialize the service.
      - def close(.)
        - Kommentar: Close the service.
      - def structured_completion(.)
        - Kommentar: Get structured completion from Google Gemini.
        - 
        - Args:
        -     prompt: The prompt to send
        -     response_model: Pydantic model for response validation
        -     model: Model to use (defaults to self.default_model)
        -     temperature: Temperature for generation (0.0-1.0)
        -     use_cache: Whether to use caching
        -     context: Additional context for the request
        - 
        - Returns:
        -     Validated response as Pydantic model instance
        - 
        - Raises:
        -     RateLimitError: If rate limited by API
        -     QuotaExceededError: If monthly budget exceeded
        -     SchemaValidationError: If response doesn't match schema
      - def analyze_order(.)
        - Kommentar: Analyze an order for risk and approval.
        - 
        - Args:
        -     order_data: Order details
        - 
        - Returns:
        -     OrderAnalysis with approval recommendation
      - def triage_alert(.)
        - Kommentar: Triage an alert to determine priority and actions.
        - 
        - Args:
        -     alert_data: Alert details
        - 
        - Returns:
        -     AlertTriageResult with priority and suggested actions
      - def review_backtest(.)
        - Kommentar: Review backtest results and provide insights.
        - 
        - Args:
        -     backtest_data: Backtest results and metrics
        - 
        - Returns:
        -     BacktestReview with insights and recommendations
      - def analyze_strategy_trades(.)
        - Kommentar: Analyze strategy trades and provide optimization suggestions.
        - 
        - Args:
        -     strategy_name: Name of the strategy
        -     symbol: Trading symbol
        -     trades: List of trade details
        -     stats: Strategy statistics
        -     strategy_params: Current strategy parameters
        - 
        - Returns:
        -     StrategyTradeAnalysis with insights and optimization suggestions
      - def get_cost_summary(.)
        - Kommentar: Get cost tracking summary.
        - 
        - Returns:
        -     Dictionary with cost stats
      - def reset_costs(.)
        - Kommentar: Reset cost tracking (e.g., at start of new month).
      - def clear_cache(.)
        - Kommentar: Clear the response cache.
    - Kommentar: Import shared models from OpenAI service
    - Kommentar: Reuse as GeminiError
  - openai_service.py
    - Class: OpenAIError
      - Kommentar: Base exception for OpenAI service errors.
    - Class: RateLimitError
      - Kommentar: Raised when rate limit is exceeded.
    - Class: QuotaExceededError
      - Kommentar: Raised when monthly budget is exceeded.
    - Class: SchemaValidationError
      - Kommentar: Raised when response doesn't match schema.
    - Class: OrderAnalysis
      - Kommentar: Structured output for order analysis.
    - Class: AlertTriageResult
      - Kommentar: Structured output for alert triage.
    - Class: BacktestReview
      - Kommentar: Structured output for backtest review.
    - Class: StrategySignalAnalysis
      - Kommentar: Structured output for strategy signal post-analysis.
    - Class: StrategyTradeAnalysis
      - Kommentar: Structured output for strategy trade analysis after Apply Strategy.
    - Class: CostTracker
      - Kommentar: Tracks AI API costs and enforces budget limits.
      - def __init__(.)
        - Kommentar: Initialize cost tracker.
        - 
        - Args:
        -     monthly_budget: Monthly budget in EUR
        -     warn_threshold: Warning threshold in EUR
      - def track_usage(.)
        - Kommentar: Track API usage and calculate cost.
        - 
        - Args:
        -     model: Model name
        -     input_tokens: Number of input tokens
        -     output_tokens: Number of output tokens
        - 
        - Returns:
        -     Cost in EUR
        - 
        - Raises:
        -     QuotaExceededError: If budget exceeded
    - Class: CacheManager
      - Kommentar: Manages caching of AI responses.
      - def __init__(.)
        - Kommentar: Initialize cache manager.
        - 
        - Args:
        -     ttl_seconds: Cache TTL in seconds
      - def _generate_key(.)
        - Kommentar: Generate cache key from request parameters.
      - def get(.)
        - Kommentar: Get cached response if available.
        - 
        - Args:
        -     prompt: The prompt
        -     model: Model name
        -     schema: Response schema
        - 
        - Returns:
        -     Cached response or None
      - def set(.)
        - Kommentar: Cache a response.
        - 
        - Args:
        -     prompt: The prompt
        -     model: Model name
        -     schema: Response schema
        -     response: The response to cache
      - def _cleanup_expired(.)
        - Kommentar: Remove expired entries from memory cache.
    - Class: OpenAIService
      - Kommentar: Main OpenAI service for structured outputs.
      - def __init__(.)
        - Kommentar: Initialize OpenAI service.
        - 
        - Args:
        -     config: AI configuration
        -     api_key: OpenAI API key
        -     telemetry_callback: Optional callback for telemetry
      - def __aenter__(.)
        - Kommentar: Async context manager entry.
      - def __aexit__(.)
        - Kommentar: Async context manager exit.
      - def initialize(.)
        - Kommentar: Initialize the service.
      - def close(.)
        - Kommentar: Close the service.
      - def structured_completion(.)
        - Kommentar: Get structured completion from OpenAI.
        - 
        - Args:
        -     prompt: The prompt
        -     response_model: Pydantic model for response structure
        -     model: Model to use (defaults to config)
        -     temperature: Temperature for generation
        -     use_cache: Whether to use caching
        -     context: Additional context for telemetry
        - 
        - Returns:
        -     Parsed response as Pydantic model instance
        - 
        - Raises:
        -     Various OpenAI errors
      - def analyze_order(.)
        - Kommentar: Analyze an order before placement.
        - 
        - Args:
        -     order_details: Order information
        -     market_context: Current market context
        - 
        - Returns:
        -     Structured order analysis
      - def triage_alert(.)
        - Kommentar: Triage an alert for priority and action.
        - 
        - Args:
        -     alert: Alert information
        -     portfolio_context: Current portfolio context
        - 
        - Returns:
        -     Structured triage result
      - def review_backtest(.)
        - Kommentar: Review backtest results with AI analysis.
        - 
        - Args:
        -     result: Complete BacktestResult from backtest run
        - 
        - Returns:
        -     Structured backtest review with insights and recommendations
      - def analyze_signal(.)
        - Kommentar: Analyze a strategy signal.
        - 
        - Args:
        -     signal: Signal information
        -     indicators: Current indicator values
        - 
        - Returns:
        -     Structured signal analysis
      - def analyze_strategy_trades(.)
        - Kommentar: Analyze strategy trades and provide improvement suggestions.
        - 
        - Args:
        -     strategy_name: Name of the strategy
        -     symbol: Trading symbol
        -     trades: List of trade dictionaries with entry/exit info
        -     stats: Statistics dict with wins, losses, win_rate, etc.
        -     strategy_params: Current strategy parameters (SL, TP, etc.)
        - 
        - Returns:
        -     Structured analysis with improvements and optimized strategy
      - def _build_order_analysis_prompt(.)
        - Kommentar: Build prompt for order analysis.
      - def _build_alert_triage_prompt(.)
        - Kommentar: Build prompt for alert triage.
      - def _build_signal_analysis_prompt(.)
        - Kommentar: Build prompt for signal analysis.
      - def _build_strategy_trade_analysis_prompt(.)
        - Kommentar: Build prompt for strategy trade analysis.
    - def get_openai_service(.)
      - Kommentar: Get or create OpenAI service instance.
      - 
      - Args:
      -     config: AI configuration
      -     api_key: OpenAI API key
      - 
      - Returns:
      -     OpenAI service instance
    - Kommentar: ==================== Singleton Instance ====================
  - prompts.py
    - Class: PromptTemplates
      - Kommentar: Collection of prompt templates for different AI tasks.
    - Class: JSONSchemas
      - Kommentar: JSON schemas for structured outputs.
    - Class: PromptBuilder
      - Kommentar: Utility class for building prompts with context.
      - def build_order_prompt(.)
        - Kommentar: Build order analysis prompt with context.
      - def build_alert_prompt(.)
        - Kommentar: Build alert triage prompt with context.
      - def build_backtest_prompt(.)
        - Kommentar: Build backtest review prompt with context.
      - def build_signal_prompt(.)
        - Kommentar: Build signal analysis prompt with context.
      - def _format_dict(.)
        - Kommentar: Format dictionary for prompt inclusion.
    - Class: SchemaValidator
      - Kommentar: Utility for validating AI responses against schemas.
      - def validate_order_analysis(.)
        - Kommentar: Validate order analysis response.
      - def validate_alert_triage(.)
        - Kommentar: Validate alert triage response.
      - def validate_backtest_review(.)
        - Kommentar: Validate backtest review response.
      - def validate_signal_analysis(.)
        - Kommentar: Validate signal analysis response.
      - def _validate_against_schema(.)
        - Kommentar: Validate data against a JSON schema.
    - Class: PromptVersion
      - Kommentar: Manages prompt versions for A/B testing and improvements.
      - def get_prompt(.)
        - Kommentar: Get a specific version of a prompt.
  - __init__.py
  - event_bus.py
    - Class: EventType
      - Kommentar: Enumeration of all event types in the system.
    - Class: Event
      - Kommentar: Base event data structure.
    - Class: OrderEvent
      - Kommentar: Order-specific event with chart-relevant information.
      - def __post_init__(.)
        - Kommentar: Ensure data dict contains chart-relevant info.
    - Class: ExecutionEvent
      - Kommentar: Execution event for chart markers (entry/exit points).
      - def __post_init__(.)
        - Kommentar: Ensure data dict contains chart-relevant info.
    - Class: EventBus
      - Kommentar: Centralized event bus for the trading application.
      - def __init__(.)
        - Kommentar: Initialize the event bus with namespaced signals.
      - def get_signal(.)
        - Kommentar: Get or create a signal for the given event type.
      - def emit(.)
        - Kommentar: Emit an event to all registered listeners.
        - 
        - Args:
        -     event: The event to emit
      - def subscribe(.)
        - Kommentar: Subscribe to an event type.
        - 
        - Args:
        -     event_type: The type of event to subscribe to
        -     handler: The callback function to handle the event
      - def unsubscribe(.)
        - Kommentar: Unsubscribe from an event type.
        - 
        - Args:
        -     event_type: The type of event to unsubscribe from
        -     handler: The callback function to remove
      - def get_history(.)
        - Kommentar: Get event history, optionally filtered by type.
        - 
        - Args:
        -     event_type: Optional filter for specific event type
        -     limit: Maximum number of events to return
        - 
        - Returns:
        -     List of events matching the criteria
      - def clear_history(.)
        - Kommentar: Clear the event history.
    - Kommentar: Global event bus instance
    - Kommentar: Convenience functions for backward compatibility
  - logging_setup.py
    - Class: AITelemetryFilter
      - Kommentar: Custom filter to add AI telemetry data to log records.
      - def filter(.)
        - Kommentar: Add AI-specific fields to the log record if present.
    - Class: TradingJsonFormatter
      - Kommentar: Custom JSON formatter for trading application logs.
      - def add_fields(.)
        - Kommentar: Add custom fields to the JSON log output.
    - def configure_logging(.)
      - Kommentar: Configure comprehensive logging for the trading application.
      - 
      - Args:
      -     level: Logging level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
      -     log_dir: Directory for log files (defaults to ./logs)
      -     enable_console: Enable console output
      -     enable_file: Enable file output
      -     enable_json: Use JSON format for logs
      -     max_bytes: Maximum size of log file before rotation
      -     backup_count: Number of backup files to keep
    - def configure_module_loggers(.)
      - Kommentar: Configure logging levels for specific modules.
    - def log_order_action(.)
      - Kommentar: Log order-related actions to the audit log.
      - 
      - Args:
      -     action: The action performed (create, submit, fill, cancel, etc.)
      -     order_id: Unique order identifier
      -     symbol: Trading symbol
      -     details: Additional order details
      -     logger_name: Name of the logger to use
    - def log_security_action(.)
      - Kommentar: Log security-relevant actions.
      - 
      - Args:
      -     action: Security action performed
      -     user_id: User identifier
      -     session_id: Session identifier
      -     ip_address: IP address
      -     details: Additional details
      -     success: Whether action succeeded
    - def get_audit_logger(.)
      - Kommentar: Get the audit logger instance.
    - def get_security_audit_logger(.)
      - Kommentar: Get the security audit logger instance.
    - def log_ai_request(.)
      - Kommentar: Log AI API requests for telemetry and cost tracking.
      - 
      - Args:
      -     model: AI model used
      -     tokens: Token count
      -     cost: Estimated cost
      -     latency: Request latency in seconds
      -     prompt_version: Version of the prompt template
      -     request_type: Type of AI request (analysis, order_review, etc.)
      -     details: Additional request details
    - def get_logger(.)
      - Kommentar: Get a logger instance with the given name.
      - 
      - Args:
      -     name: Logger name (usually __name__)
      - 
      - Returns:
      -     Configured logger instance
    - Kommentar: Import security types for audit logging
    - Kommentar: Fallback if security_core not available
  - security_core.py
    - Class: SecurityLevel
      - Kommentar: Security levels for operations.
    - Class: SecurityAction
      - Kommentar: Security-relevant actions.
    - Class: SecurityContext
      - Kommentar: Security context for operations.
      - def __post_init__(.)
    - Class: RateLimiter
      - Kommentar: Rate limiting implementation with sliding window.
      - def __init__(.)
        - Kommentar: Initialize rate limiter.
        - 
        - Args:
        -     max_requests: Maximum requests in window
        -     window_seconds: Time window in seconds
      - def is_allowed(.)
        - Kommentar: Check if request is allowed.
        - 
        - Args:
        -     key: Unique identifier for rate limiting
        - 
        - Returns:
        -     True if request is allowed
      - def get_remaining(.)
        - Kommentar: Get remaining requests in current window.
    - def hash_password(.)
      - Kommentar: Hash password with salt.
      - 
      - Args:
      -     password: Plain text password
      -     salt: Optional salt (generated if None)
      - 
      - Returns:
      -     Tuple of (hashed_password, salt)
    - def verify_password(.)
      - Kommentar: Verify password against stored hash.
      - 
      - Args:
      -     password: Plain text password
      -     stored_hash: Stored password hash
      -     salt: Salt used for hashing
      - 
      - Returns:
      -     True if password is correct
    - def generate_api_key(.)
      - Kommentar: Generate a secure API key.
      - 
      - Returns:
      -     URL-safe base64 encoded API key
    - def validate_api_key(.)
      - Kommentar: Validate API key format.
      - 
      - Args:
      -     api_key: API key to validate
      - 
      - Returns:
      -     True if format is valid
    - def rate_limit(.)
      - Kommentar: Rate limiting decorator.
      - 
      - Args:
      -     key: Rate limiting key
      -     max_requests: Max requests per window
      -     window_seconds: Window size in seconds
      - 
      - Returns:
      -     Decorator function
    - def is_strong_password(.)
      - Kommentar: Check if password meets strength requirements.
      - 
      - Args:
      -     password: Password to check
      - 
      - Returns:
      -     True if password is strong
    - def sanitize_input(.)
      - Kommentar: Sanitize user input.
      - 
      - Args:
      -     value: Input to sanitize
      -     max_length: Maximum allowed length
      - 
      - Returns:
      -     Sanitized input
    - Kommentar: Global rate limiter instance
  - __init__.py
    - Kommentar: Enums
    - Kommentar: Config classes
    - Kommentar: Manager
  - loader.py
    - Class: TradingEnvironment
      - Kommentar: Trading environment modes.
    - Class: TradingMode
      - Kommentar: Trading execution modes.
      - 
      - BACKTEST: Historical backtesting with synthetic data
      - PAPER: Real-time paper trading with simulated execution
      - LIVE: Real-time live trading with actual money
    - Class: BrokerType
      - Kommentar: Supported broker types.
    - Class: BrokerConfig
      - Kommentar: Broker connection configuration.
    - Class: DatabaseConfig
      - Kommentar: Database configuration.
    - Class: MarketDataProviderConfig
      - Kommentar: Market data provider configuration and toggles.
    - Class: AIConfig
      - Kommentar: OpenAI API configuration.
    - Class: TradingConfig
      - Kommentar: Trading parameters and risk management.
    - Class: BacktestConfig
      - Kommentar: Backtesting configuration.
    - Class: AlertConfig
      - Kommentar: Alert and notification settings.
    - Class: UIConfig
      - Kommentar: User interface configuration.
    - Class: MonitoringConfig
      - Kommentar: Performance monitoring and metrics.
    - Class: ExecutionConfig
      - Kommentar: Order execution settings.
    - Class: ProfileConfig
      - Kommentar: Complete trading profile configuration.
      - def validate_environment(.)
        - Kommentar: Ensure production environment has proper safeguards.
      - def validate_trading_mode_field(.)
        - Kommentar: Convert string to enum if needed.
      - def validate_trading_mode_config(.)
        - Kommentar: Ensure trading mode has appropriate safety settings.
      - def is_safe_for_mode(.)
        - Kommentar: Check if current configuration is safe for specified mode.
        - 
        - Args:
        -     mode: Trading mode to validate
        - 
        - Returns:
        -     Tuple of (is_safe, list of warnings/errors)
      - def switch_to_mode(.)
        - Kommentar: Switch to specified trading mode with safety checks.
        - 
        - Args:
        -     mode: Trading mode to switch to
        -     validate: Whether to validate the switch (default: True)
        - 
        - Raises:
        -     ValueError: If validation fails and validate=True
      - def create_backtest_profile(.)
        - Kommentar: Create a profile optimized for backtesting.
        - 
        - Args:
        -     name: Profile name
        -     initial_capital: Initial capital for backtest
        - 
        - Returns:
        -     ProfileConfig configured for backtesting
      - def create_paper_profile(.)
        - Kommentar: Create a profile for paper trading.
        - 
        - Args:
        -     name: Profile name
        -     broker_type: Broker to use for paper trading
        - 
        - Returns:
        -     ProfileConfig configured for paper trading
      - def create_live_profile(.)
        - Kommentar: Create a profile for live trading with maximum safety.
        - 
        - Args:
        -     name: Profile name
        -     broker_type: Broker to use for live trading
        - 
        - Returns:
        -     ProfileConfig configured for live trading
        - 
        - Warning:
        -     Live trading involves real money. Ensure all settings are correct.
    - Class: AppSettings
      - Kommentar: Application-wide settings from environment variables.
    - Class: ConfigManager
      - Kommentar: Manages application configuration and profiles.
      - def __init__(.)
        - Kommentar: Initialize the configuration manager.
        - 
        - Args:
        -     config_dir: Directory containing configuration files
      - def load_profile(.)
        - Kommentar: Load a configuration profile.
        - 
        - Args:
        -     profile_name: Name of the profile to load
        - 
        - Returns:
        -     Loaded profile configuration
      - def save_profile(.)
        - Kommentar: Save the current profile to disk.
        - 
        - Args:
        -     profile: Profile to save (uses current if not provided)
      - def get_credential(.)
        - Kommentar: Retrieve a credential from .env file or Windows Credential Manager.
        - 
        - Priority:
        - 1. Check in-memory cache
        - 2. Check .env file in config/secrets/
        - 3. Check Windows Credential Manager
        - 
        - Args:
        -     key: Credential key (e.g., 'openai_api_key', 'alpaca_api_key')
        -     service: Service name for keyring
        - 
        - Returns:
        -     Credential value or None if not found
      - def set_credential(.)
        - Kommentar: Store a credential in Windows Credential Manager.
        - 
        - Args:
        -     key: Credential key
        -     value: Credential value
        -     service: Service name for keyring
      - def list_profiles(.)
        - Kommentar: List available configuration profiles.
        - 
        - Returns:
        -     List of profile names
      - def export_config(.)
        - Kommentar: Export current configuration (without secrets).
        - 
        - Args:
        -     path: Path to export configuration to
      - def save_watchlist(.)
        - Kommentar: Save watchlist to persistent storage.
      - def load_watchlist(.)
        - Kommentar: Load watchlist from persistent storage.
        - 
        - Returns:
        -     List of symbols in watchlist
      - def profile(.)
        - Kommentar: Get the current profile configuration.
    - Kommentar: Global configuration instance
  - __init__.py
  - __init__.py
    - Kommentar: Import new comprehensive BacktestResult from models
    - Kommentar: Configuration
    - Kommentar: Engine
    - Kommentar: New comprehensive models (preferred)
    - Kommentar: Legacy model (deprecated)
  - backtrader_integration.py
    - Class: BacktestConfig
      - Kommentar: Configuration for backtesting.
      - def __post_init__(.)
    - Class: BacktestResultLegacy
      - Kommentar: Legacy results from backtesting (deprecated, use BacktestResult from models).
      - 
      - Kept for backward compatibility only. New code should use
      - src.core.models.backtest_models.BacktestResult instead.
    - Class: OrderPilotStrategy
      - Kommentar: Backtrader strategy wrapper for OrderPilot strategies.
      - def __init__(.)
        - Kommentar: Initialize strategy.
      - def notify_order(.)
        - Kommentar: Handle order notifications.
      - def notify_trade(.)
        - Kommentar: Handle trade notifications.
      - def next(.)
        - Kommentar: Process next bar - async version.
      - def _get_dataframe(.)
        - Kommentar: Convert Backtrader data to DataFrame.
      - def _execute_signal(.)
        - Kommentar: Execute trading signal.
      - def _calculate_size(.)
        - Kommentar: Calculate position size.
      - def log(.)
        - Kommentar: Logging function.
    - Class: BacktestEngine
      - Kommentar: Engine for running backtests with Backtrader.
      - def __init__(.)
        - Kommentar: Initialize backtest engine.
        - 
        - Args:
        -     history_manager: Historical data manager (optional, only needed if fetching from data sources)
      - def run_backtest(.)
        - Kommentar: Run a backtest.
        - 
        - Args:
        -     config: Backtest configuration
        - 
        - Returns:
        -     Backtest results
      - def _get_data_feed(.)
        - Kommentar: Get data feed for symbol.
        - 
        - Args:
        -     symbol: Trading symbol
        -     start_date: Start date
        -     end_date: End date
        -     timeframe: Data timeframe
        - 
        - Returns:
        -     Backtrader data feed or None
      - def _process_results(.)
        - Kommentar: Process backtest results using comprehensive BacktestResult model.
        - 
        - Args:
        -     strategy: Backtrader strategy instance
        -     initial_value: Initial portfolio value
        -     final_value: Final portfolio value
        -     config: Backtest configuration
        -     cerebro: Optional Backtrader Cerebro instance
        - 
        - Returns:
        -     Comprehensive BacktestResult
      - def run_backtest_with_definition(.)
        - Kommentar: Run backtest with StrategyDefinition (YAML/JSON strategy).
        - 
        - This method compiles a declarative strategy definition into a Backtrader
        - strategy and runs a backtest with it.
        - 
        - Args:
        -     strategy_def: Strategy definition (loaded from YAML/JSON)
        -     symbol: Trading symbol
        -     start_date: Backtest start date
        -     end_date: Backtest end date
        -     initial_cash: Starting capital
        -     commission: Commission rate (default 0.1%)
        -     timeframe: Data timeframe
        -     data_feed: Optional custom data feed (if None, fetches from history manager)
        - 
        - Returns:
        -     Comprehensive backtest results
        - 
        - Example:
        -     >>> from src.core.strategy.definition import StrategyDefinition
        -     >>> strategy_def = StrategyDefinition.from_yaml(yaml_content)
        -     >>> result = await engine.run_backtest_with_definition(
        -     ...     strategy_def=strategy_def,
        -     ...     symbol="AAPL",
        -     ...     start_date=datetime(2023, 1, 1),
        -     ...     end_date=datetime(2023, 12, 31)
        -     ... )
      - def optimize_strategy(.)
        - Kommentar: Optimize strategy parameters.
        - 
        - Args:
        -     config: Backtest configuration with optimize_params
        - 
        - Returns:
        -     List of (params, results) tuples sorted by Sharpe ratio
      - def _generate_param_combinations(.)
        - Kommentar: Generate parameter combinations for optimization.
        - 
        - Args:
        -     optimize_params: Parameter ranges
        - 
        - Returns:
        -     List of parameter combinations
      - def plot_results(.)
        - Kommentar: Plot backtest results.
        - 
        - Args:
        -     result: Backtest results (new comprehensive model)
        -     show: Whether to show plot
    - Kommentar: Try importing backtrader
  - optimization.py
    - Class: ParameterRange
      - Kommentar: Parameter range for optimization.
    - Class: OptimizationMetric
      - Kommentar: Metric for optimization.
    - Class: ParameterTest
      - Kommentar: Single parameter test result.
    - Class: OptimizationResult
      - Kommentar: Complete optimization result.
    - Class: AIOptimizationInsight
      - Kommentar: AI-generated optimization insights.
    - Class: OptimizerConfig
      - Kommentar: Configuration for parameter optimizer.
    - Class: ParameterOptimizer
      - Kommentar: AI-guided parameter optimizer for trading strategies.
      - def __init__(.)
        - Kommentar: Initialize parameter optimizer.
        - 
        - Args:
        -     backtest_runner: Async function that runs backtest with parameters
        -                     Signature: async def runner(params: dict) -> BacktestResult
        -     config: Optimizer configuration
      - def grid_search(.)
        - Kommentar: Perform grid search optimization.
        - 
        - Args:
        -     parameter_ranges: Parameter ranges to search
        -     base_params: Base parameters (not optimized)
        - 
        - Returns:
        -     Optimization result with best parameters
      - def optimize_with_ai(.)
        - Kommentar: Perform AI-guided optimization with iterative refinement.
        - 
        - Args:
        -     parameter_ranges: Initial parameter ranges
        -     base_params: Base parameters
        -     max_iterations: Maximum optimization iterations
        - 
        - Returns:
        -     Tuple of (optimization result, AI insights)
      - def _calculate_score(.)
        - Kommentar: Calculate optimization score for a backtest result.
        - 
        - Args:
        -     result: Backtest result
        - 
        - Returns:
        -     Optimization score (higher is better)
      - def _get_metric_value(.)
        - Kommentar: Extract metric value from backtest result.
        - 
        - Args:
        -     result: Backtest result
        -     metric_name: Name of metric to extract
        - 
        - Returns:
        -     Metric value or None if not found
      - def _extract_metrics(.)
        - Kommentar: Extract key metrics from backtest result.
        - 
        - Args:
        -     result: Backtest result
        - 
        - Returns:
        -     Dictionary of key metrics
      - def _analyze_sensitivity(.)
        - Kommentar: Analyze parameter sensitivity.
        - 
        - Args:
        -     parameter_ranges: Parameter ranges tested
        - 
        - Returns:
        -     Sensitivity analysis for each parameter
      - def _get_ai_insights(.)
        - Kommentar: Get AI insights about optimization results.
        - 
        - Args:
        -     result: Optimization result
        - 
        - Returns:
        -     AI-generated insights
      - def _build_optimization_prompt(.)
        - Kommentar: Build prompt for AI optimization analysis.
        - 
        - Args:
        -     result: Optimization result
        - 
        - Returns:
        -     Prompt for AI analysis
      - def _refine_ranges(.)
        - Kommentar: Refine parameter ranges based on AI insights.
        - 
        - Args:
        -     current_ranges: Current parameter ranges
        -     result: Optimization result
        -     insights: AI insights
        - 
        - Returns:
        -     Refined parameter ranges
    - def quick_optimize(.)
      - Kommentar: Quick parameter optimization with default settings.
      - 
      - Args:
      -     backtest_runner: Async backtest runner function
      -     parameter_ranges: Dict of parameter name to list of values
      -     base_params: Base parameters
      -     primary_metric: Metric to optimize
      - 
      - Returns:
      -     Optimization result
      - 
      - Example:
      -     >>> async def run_backtest(params):
      -     ...     # Run backtest with params
      -     ...     return backtest_result
      -     >>>
      -     >>> result = await quick_optimize(
      -     ...     run_backtest,
      -     ...     {"fast_period": [10, 15, 20], "slow_period": [40, 50, 60]},
      -     ...     primary_metric="sharpe_ratio"
      -     ... )
    - Kommentar: ==================== Optimizer ====================
  - result_converter.py
    - def backtrader_to_backtest_result(.)
      - Kommentar: Convert Backtrader results to comprehensive BacktestResult.
      - 
      - Args:
      -     strategy: Backtrader strategy instance with analyzers
      -     cerebro: Backtrader Cerebro instance
      -     initial_value: Initial portfolio value
      -     final_value: Final portfolio value
      -     symbol: Primary trading symbol
      -     timeframe: Data timeframe (e.g., '1min', '1D')
      -     start_date: Backtest start datetime
      -     end_date: Backtest end datetime
      -     strategy_name: Optional strategy identifier
      -     strategy_params: Optional strategy parameters
      - 
      - Returns:
      -     Comprehensive BacktestResult instance
      - 
      - Raises:
      -     ValueError: If required data is missing
    - def _extract_bars_from_strategy(.)
      - Kommentar: Extract OHLCV bars from Backtrader strategy data feed.
      - 
      - Args:
      -     strategy: Backtrader strategy instance
      -     symbol: Trading symbol
      - 
      - Returns:
      -     List of Bar instances
    - def _extract_trades_from_strategy(.)
      - Kommentar: Extract trades from Backtrader strategy.
      - 
      - Args:
      -     strategy: Backtrader strategy instance
      -     symbol: Trading symbol
      - 
      - Returns:
      -     List of Trade instances
    - def _extract_equity_curve(.)
      - Kommentar: Extract equity curve from Backtrader strategy.
      - 
      - Args:
      -     strategy: Backtrader strategy instance
      -     initial_value: Initial portfolio value
      - 
      - Returns:
      -     List of EquityPoint instances
    - def _calculate_metrics(.)
      - Kommentar: Calculate comprehensive backtest metrics.
      - 
      - Args:
      -     trades: List of Trade instances
      -     equity_curve: List of EquityPoint instances
      -     initial_capital: Initial portfolio value
      -     final_capital: Final portfolio value
      -     start_date: Backtest start datetime
      -     end_date: Backtest end datetime
      -     strategy_analyzers: Backtrader analyzers object
      - 
      - Returns:
      -     BacktestMetrics instance
    - def _calculate_max_consecutive(.)
      - Kommentar: Calculate maximum consecutive wins or losses.
      - 
      - Args:
      -     trades: List of Trade instances
      -     is_winner: True to count wins, False to count losses
      - 
      - Returns:
      -     Maximum consecutive count
    - def _extract_indicators(.)
      - Kommentar: Extract indicator values from Backtrader strategy.
      - 
      - Args:
      -     strategy: Backtrader strategy instance
      - 
      - Returns:
      -     Dictionary mapping indicator names to time-series data
  - __init__.py
    - Kommentar: Base classes and interfaces
    - Kommentar: Errors
    - Kommentar: Data models
    - Kommentar: AI hooks
    - Kommentar: Rate limiting
    - Kommentar: Implementations
  - base.py
    - Class: BrokerError
      - Kommentar: Base exception for broker-related errors.
      - def __init__(.)
    - Class: BrokerConnectionError
      - Kommentar: Raised when broker connection fails.
    - Class: OrderValidationError
      - Kommentar: Raised when order validation fails.
    - Class: InsufficientFundsError
      - Kommentar: Raised when account has insufficient funds.
    - Class: RateLimitError
      - Kommentar: Raised when rate limit is exceeded.
    - Class: OrderRequest
      - Kommentar: Standardized order request.
      - def validate_limit_price(.)
        - Kommentar: Ensure limit price is set for limit orders.
      - def validate_stop_price(.)
        - Kommentar: Ensure stop price is set for stop orders.
    - Class: OrderResponse
      - Kommentar: Standardized order response.
    - Class: Position
      - Kommentar: Current position information.
      - def is_long(.)
      - def is_short(.)
    - Class: Balance
      - Kommentar: Account balance information.
    - Class: FeeModel
      - Kommentar: Fee calculation model.
      - def calculate(.)
        - Kommentar: Calculate total fee for an order.
    - Class: AIAnalysisRequest
      - Kommentar: Request for AI analysis before order placement.
    - Class: AIAnalysisResult
      - Kommentar: Result from AI analysis.
    - Class: TokenBucketRateLimiter
      - Kommentar: Token bucket rate limiter for API calls.
      - def __init__(.)
        - Kommentar: Initialize rate limiter.
        - 
        - Args:
        -     rate: Tokens per second
        -     burst: Maximum burst size
      - def acquire(.)
        - Kommentar: Acquire tokens, blocking if necessary.
      - def try_acquire(.)
        - Kommentar: Try to acquire tokens without blocking.
    - Class: BrokerAdapter
      - Kommentar: Abstract base class for broker integrations with template methods.
      - def __init__(.)
        - Kommentar: Initialize broker adapter.
        - 
        - Args:
        -     name: Broker name
        -     fee_model: Fee calculation model
        -     rate_limit: Rate limiter instance
        -     ai_hook: AI analysis hook function
        -     **kwargs: Additional broker-specific parameters
      - def connect(.)
        - Kommentar: Establish connection to broker using template method pattern.
        - 
        - This method coordinates the connection process:
        - 1. Validate credentials
        - 2. Establish broker-specific connection
        - 3. Verify connection is working
        - 4. Set up initial state (optional)
        - 
        - Subclasses should implement _establish_connection() for broker-specific logic.
      - def disconnect(.)
        - Kommentar: Disconnect from broker using template method pattern.
        - 
        - This method coordinates the disconnection process:
        - 1. Cleanup broker-specific resources
        - 2. Reset connection state
        - 3. Log disconnection
        - 
        - Subclasses should implement _cleanup_resources() for broker-specific cleanup.
      - def is_connected(.)
        - Kommentar: Check if connected to broker.
        - 
        - Default implementation checks the _connected flag.
        - Subclasses can override for more sophisticated checks.
        - 
        - Returns:
        -     True if connected
      - def _validate_credentials(.)
        - Kommentar: Validate credentials before connecting.
        - 
        - Optional hook for subclasses to validate API keys, tokens, etc.
        - Default implementation does nothing.
      - def _establish_connection(.)
        - Kommentar: Establish broker-specific connection.
        - 
        - Required method for subclasses to implement the actual
        - connection logic (e.g., create client, connect WebSocket, etc.).
        - 
        - Raises:
        -     BrokerConnectionError: If connection fails
      - def _verify_connection(.)
        - Kommentar: Verify the connection is working.
        - 
        - Optional hook for subclasses to test the connection
        - (e.g., make a test API call).
        - Default implementation does nothing.
      - def _setup_initial_state(.)
        - Kommentar: Set up initial state after connection.
        - 
        - Optional hook for subclasses to request initial data,
        - subscribe to streams, etc.
        - Default implementation does nothing.
      - def _cleanup_resources(.)
        - Kommentar: Clean up broker-specific resources.
        - 
        - Required method for subclasses to implement cleanup logic
        - (e.g., close clients, cancel tasks, close WebSockets).
      - def _ensure_connected(.)
        - Kommentar: Ensure the adapter is connected.
        - 
        - Raises:
        -     BrokerConnectionError: If not connected
      - def is_available(.)
        - Kommentar: Check if broker API is available.
        - 
        - Default implementation tries to establish connection and check status.
        - Subclasses can override for more sophisticated health checks.
        - 
        - Returns:
        -     True if broker is available
      - def _check_api_status(.)
        - Kommentar: Check broker API status.
        - 
        - Optional hook for subclasses to implement API health check.
        - Default implementation returns True if connected.
        - 
        - Returns:
        -     True if API is healthy
      - def place_order(.)
        - Kommentar: Place an order with the broker.
        - 
        - Args:
        -     order: Order request details
        - 
        - Returns:
        -     Order response with broker confirmation
        - 
        - Raises:
        -     Various broker errors
      - def _place_order_impl(.)
        - Kommentar: Internal implementation of order placement.
      - def cancel_order(.)
        - Kommentar: Cancel an order.
        - 
        - Args:
        -     order_id: Broker order ID
        - 
        - Returns:
        -     True if cancellation successful
      - def get_order_status(.)
        - Kommentar: Get current order status.
        - 
        - Args:
        -     order_id: Broker order ID
        - 
        - Returns:
        -     Current order information
      - def get_positions(.)
        - Kommentar: Get all current positions.
      - def get_balance(.)
        - Kommentar: Get account balance.
      - def get_quote(.)
        - Kommentar: Get current quote for symbol (if supported).
      - def _validate_order(.)
        - Kommentar: Validate order parameters.
      - def calculate_fee(.)
        - Kommentar: Calculate estimated fee for order.
      - def activate_kill_switch(.)
        - Kommentar: Activate the kill switch to halt all trading.
      - def deactivate_kill_switch(.)
        - Kommentar: Deactivate the kill switch.
  - ibkr_adapter.py
    - Class: IBKRWrapper
      - Kommentar: IB API Wrapper for handling callbacks.
      - def __init__(.)
      - def nextValidId(.)
        - Kommentar: Callback for next valid order ID.
      - def connectionClosed(.)
        - Kommentar: Callback when connection is closed.
      - def error(.)
        - Kommentar: Error callback.
      - def orderStatus(.)
        - Kommentar: Order status update callback.
      - def position(.)
        - Kommentar: Position update callback.
      - def accountSummary(.)
        - Kommentar: Account summary callback.
      - def historicalData(.)
        - Kommentar: Historical data callback.
      - def tickPrice(.)
        - Kommentar: Tick price callback.
      - def _map_order_status(.)
        - Kommentar: Map IB order status to internal status.
    - Class: IBKRClient
      - Kommentar: IB API Client.
      - def __init__(.)
    - Class: IBKRAdapter
      - Kommentar: Interactive Brokers adapter using official TWS/Gateway API.
      - def __init__(.)
        - Kommentar: Initialize IBKR adapter.
        - 
        - Args:
        -     host: TWS/Gateway host
        -     port: TWS/Gateway port (7497 for paper, 7496 for live)
        -     client_id: Unique client ID
        -     paper_trading: Whether to use paper trading
        -     **kwargs: Additional arguments for base class
      - def _get_next_req_id(.)
        - Kommentar: Get next request ID thread-safely.
      - def _establish_connection(.)
        - Kommentar: Establish connection to IBKR TWS/Gateway (template method implementation).
      - def _verify_connection(.)
        - Kommentar: Verify IBKR connection by waiting for connection event.
      - def _setup_initial_state(.)
        - Kommentar: Request initial account and position data (template method implementation).
      - def _cleanup_resources(.)
        - Kommentar: Clean up IBKR resources (template method implementation).
      - def is_connected(.)
        - Kommentar: Check if connected to IBKR.
      - def _place_order_impl(.)
        - Kommentar: Place order with IBKR.
      - def _create_contract(.)
        - Kommentar: Create IB contract object.
      - def _create_ib_order(.)
        - Kommentar: Create IB order object.
      - def cancel_order(.)
        - Kommentar: Cancel an order.
      - def get_order_status(.)
        - Kommentar: Get current order status.
      - def get_positions(.)
        - Kommentar: Get all current positions.
      - def get_balance(.)
        - Kommentar: Get account balance.
      - def get_quote(.)
        - Kommentar: Get current quote for symbol.
      - def get_historical_bars(.)
        - Kommentar: Get historical bars for symbol.
        - 
        - Args:
        -     symbol: Trading symbol
        -     duration: Duration string (e.g., "1 D", "1 W")
        -     bar_size: Bar size (e.g., "1 min", "5 mins", "1 hour")
        - 
        - Returns:
        -     List of bar data
  - mock_broker.py
    - Class: MockBroker
      - Kommentar: Mock broker for testing and development.
      - def __init__(.)
        - Kommentar: Initialize mock broker.
        - 
        - Args:
        -     initial_cash: Starting cash balance
        -     **kwargs: Additional arguments for base class
      - def _establish_connection(.)
        - Kommentar: Simulate broker connection (template method implementation).
      - def _cleanup_resources(.)
        - Kommentar: Clean up mock broker resources (template method implementation).
      - def _place_order_impl(.)
        - Kommentar: Place order in mock broker.
      - def _simulate_fill(.)
        - Kommentar: Simulate order fill.
      - def _update_position(.)
        - Kommentar: Update position after fill.
      - def cancel_order(.)
        - Kommentar: Cancel an order.
      - def get_order_status(.)
        - Kommentar: Get order status.
      - def get_positions(.)
        - Kommentar: Get all positions.
      - def get_balance(.)
        - Kommentar: Get account balance.
      - def get_quote(.)
        - Kommentar: Get current quote for symbol.
      - def _get_market_price(.)
        - Kommentar: Get simulated market price.
      - def set_market_price(.)
        - Kommentar: Set market price for testing.
  - trade_republic_adapter.py
    - Class: TradeRepublicAdapter
      - Kommentar: Trade Republic broker adapter using unofficial API.
      - 
      - WARNING: This implementation uses unofficial/private APIs that may:
      - - Change without notice
      - - Violate Terms of Service
      - - Result in account suspension
      - - Not work reliably
      - 
      - Use at your own risk. Consider using IBKR for production trading.
      - def __init__(.)
        - Kommentar: Initialize Trade Republic adapter.
        - 
        - Args:
        -     phone_number: Phone number for authentication
        -     pin: PIN for authentication
        -     **kwargs: Additional arguments for base class
      - def _establish_connection(.)
        - Kommentar: Establish connection to Trade Republic (template method implementation).
      - def _setup_initial_state(.)
        - Kommentar: Set up initial state after connection (template method implementation).
      - def _authenticate(.)
        - Kommentar: Authenticate with Trade Republic.
      - def _connect_websocket(.)
        - Kommentar: Connect to Trade Republic WebSocket.
      - def _listen_websocket(.)
        - Kommentar: Listen for WebSocket messages.
      - def _handle_ws_message(.)
        - Kommentar: Handle incoming WebSocket message.
      - def _heartbeat_loop(.)
        - Kommentar: Send periodic heartbeat to keep connection alive.
      - def _reconnect(.)
        - Kommentar: Reconnect with exponential backoff.
      - def _cleanup_resources(.)
        - Kommentar: Clean up Trade Republic resources (template method implementation).
      - def is_connected(.)
        - Kommentar: Check if connected to Trade Republic.
      - def _place_order_impl(.)
        - Kommentar: Place order with Trade Republic.
      - def cancel_order(.)
        - Kommentar: Cancel an order.
      - def get_order_status(.)
        - Kommentar: Get current order status.
      - def get_positions(.)
        - Kommentar: Get all current positions.
      - def get_balance(.)
        - Kommentar: Get account balance.
      - def _rate_limit(.)
        - Kommentar: Enforce rate limiting.
      - def _get_isin(.)
        - Kommentar: Convert symbol to ISIN.
      - def _map_order_type(.)
        - Kommentar: Map internal order type to TR API format.
      - def _parse_order_response(.)
        - Kommentar: Parse order response from API.
      - def _parse_position(.)
        - Kommentar: Parse position from API response.
      - def _handle_ticker(.)
        - Kommentar: Handle ticker updates from WebSocket.
      - def _handle_order_update(.)
        - Kommentar: Handle order status updates from WebSocket.
  - __init__.py
  - events.py
    - Class: OrderEventEmitter
      - Kommentar: Emits order events to the event bus for chart markers and UI updates.
      - def __init__(.)
        - Kommentar: Initialize the order event emitter.
        - 
        - Args:
        -     symbol: Trading symbol
        -     source: Event source identifier
      - def emit_order_created(.)
        - Kommentar: Emit ORDER_CREATED event.
        - 
        - Args:
        -     order_id: Unique order identifier
        -     order_type: Order type (market, limit, stop, etc.)
        -     side: Order side (buy, sell, long, short)
        -     quantity: Order quantity
        -     price: Order price (None for market orders)
        -     **kwargs: Additional metadata
      - def emit_order_submitted(.)
        - Kommentar: Emit ORDER_SUBMITTED event.
      - def emit_order_filled(.)
        - Kommentar: Emit ORDER_FILLED event.
        - 
        - Args:
        -     order_id: Order identifier
        -     filled_quantity: Quantity filled
        -     avg_fill_price: Average fill price
        -     **kwargs: Additional metadata
      - def emit_order_partial_fill(.)
        - Kommentar: Emit ORDER_PARTIAL_FILL event.
      - def emit_order_cancelled(.)
        - Kommentar: Emit ORDER_CANCELLED event.
      - def emit_order_rejected(.)
        - Kommentar: Emit ORDER_REJECTED event.
    - Class: ExecutionEventEmitter
      - Kommentar: Emits execution events (trade entry/exit) for chart markers.
      - def __init__(.)
        - Kommentar: Initialize the execution event emitter.
        - 
        - Args:
        -     symbol: Trading symbol
        -     source: Event source identifier
      - def emit_trade_entry(.)
        - Kommentar: Emit TRADE_ENTRY event for chart marker.
        - 
        - Args:
        -     trade_id: Unique trade identifier
        -     side: Trade side (long, short)
        -     quantity: Entry quantity
        -     price: Entry price
        -     **kwargs: Additional metadata
      - def emit_trade_exit(.)
        - Kommentar: Emit TRADE_EXIT event for chart marker.
        - 
        - Args:
        -     trade_id: Trade identifier
        -     side: Trade side (long, short)
        -     quantity: Exit quantity
        -     price: Exit price
        -     pnl: Profit/loss in currency
        -     pnl_pct: Profit/loss percentage
        -     reason: Exit reason (signal, stop_loss, take_profit, manual)
        -     **kwargs: Additional metadata
      - def emit_stop_loss_hit(.)
        - Kommentar: Emit STOP_LOSS_HIT event.
      - def emit_take_profit_hit(.)
        - Kommentar: Emit TAKE_PROFIT_HIT event.
      - def emit_position_opened(.)
        - Kommentar: Emit POSITION_OPENED event.
      - def emit_position_closed(.)
        - Kommentar: Emit POSITION_CLOSED event.
    - Class: BacktraderEventAdapter
      - Kommentar: Adapter to emit events from Backtrader strategy execution.
      - def __init__(.)
        - Kommentar: Initialize the Backtrader event adapter.
        - 
        - Args:
        -     symbol: Trading symbol
        -     source: Event source (default: "backtest")
      - def on_order_created(.)
        - Kommentar: Handle order created by Backtrader.
      - def on_order_submitted(.)
        - Kommentar: Handle order submitted.
      - def on_order_filled(.)
        - Kommentar: Handle order filled and emit appropriate events.
      - def on_order_cancelled(.)
        - Kommentar: Handle order cancelled.
      - def on_order_rejected(.)
        - Kommentar: Handle order rejected.
      - def _get_order_type(.)
        - Kommentar: Get order type string from Backtrader order.
      - def _get_order_side(.)
        - Kommentar: Get order side from Backtrader order.
  - __init__.py
    - Kommentar: Re-export all types and classes for backward compatibility
    - Kommentar: Main engine
    - Kommentar: Types
    - Kommentar: Calculator classes
    - Kommentar: Library availability flags
  - base.py
    - Class: BaseIndicatorCalculator
      - Kommentar: Base class for indicator calculators.
      - 
      - Provides common utilities and validation logic.
      - def validate_data(.)
        - Kommentar: Validate input data.
        - 
        - Args:
        -     data: OHLCV DataFrame
        -     config: Indicator configuration
        - 
        - Returns:
        -     True if valid
      - def create_result(.)
        - Kommentar: Create indicator result.
        - 
        - Args:
        -     indicator_type: Type of indicator
        -     values: Calculated values
        -     params: Calculation parameters
        -     metadata: Optional metadata
        - 
        - Returns:
        -     Indicator result
    - Kommentar: Try to import TA-Lib (optional dependency)
    - Kommentar: Try to import pandas_ta (fallback for TA-Lib)
    - Kommentar: Export library availability flags
    - Kommentar: Only export talib if available
    - Kommentar: Only export pandas_ta if available
  - custom.py
    - Class: CustomIndicators
      - Kommentar: Calculator for custom indicators.
      - def calculate_pivots(.)
        - Kommentar: Calculate Pivot Points.
      - def calculate_support_resistance(.)
        - Kommentar: Calculate Support and Resistance levels.
      - def calculate_patterns(.)
        - Kommentar: Detect price patterns.
    - Kommentar: Import optional libraries
  - engine.py
    - Class: IndicatorEngine
      - Kommentar: Engine for calculating technical indicators.
      - def __init__(.)
        - Kommentar: Initialize indicator engine.
        - 
        - Args:
        -     cache_size: Size of LRU cache for results
      - def calculate(.)
        - Kommentar: Calculate indicator for given data.
        - 
        - Args:
        -     data: OHLCV DataFrame with columns: open, high, low, close, volume
        -     config: Indicator configuration
        - 
        - Returns:
        -     Indicator result
      - def calculate_multiple(.)
        - Kommentar: Calculate multiple indicators.
        - 
        - Args:
        -     data: OHLCV DataFrame
        -     configs: List of indicator configurations
        - 
        - Returns:
        -     Dictionary of results by indicator type
      - def _get_cache_key(.)
        - Kommentar: Generate cache key.
      - def clear_cache(.)
        - Kommentar: Clear indicator cache.
  - momentum.py
    - Class: MomentumIndicators
      - Kommentar: Calculator for momentum indicators.
      - def calculate_rsi(.)
        - Kommentar: Calculate RSI.
      - def calculate_stoch(.)
        - Kommentar: Calculate Stochastic Oscillator.
      - def calculate_mom(.)
        - Kommentar: Calculate Momentum.
      - def calculate_roc(.)
        - Kommentar: Calculate Rate of Change.
      - def calculate_willr(.)
        - Kommentar: Calculate Williams %R.
      - def calculate_cci(.)
        - Kommentar: Calculate CCI.
      - def calculate_mfi(.)
        - Kommentar: Calculate Money Flow Index.
    - Kommentar: Import optional libraries
  - trend.py
    - Class: TrendIndicators
      - Kommentar: Calculator for trend indicators.
      - def calculate_sma(.)
        - Kommentar: Calculate Simple Moving Average.
      - def calculate_ema(.)
        - Kommentar: Calculate Exponential Moving Average.
      - def calculate_wma(.)
        - Kommentar: Calculate Weighted Moving Average.
      - def calculate_vwma(.)
        - Kommentar: Calculate Volume Weighted Moving Average.
      - def calculate_macd(.)
        - Kommentar: Calculate MACD.
      - def calculate_adx(.)
        - Kommentar: Calculate ADX.
      - def calculate_psar(.)
        - Kommentar: Calculate Parabolic SAR.
      - def calculate_ichimoku(.)
        - Kommentar: Calculate Ichimoku Cloud.
    - Kommentar: Import optional libraries
  - types.py
    - Class: IndicatorType
      - Kommentar: Types of technical indicators.
    - Class: IndicatorConfig
      - Kommentar: Configuration for an indicator.
    - Class: IndicatorResult
      - Kommentar: Result from indicator calculation.
  - volatility.py
    - Class: VolatilityIndicators
      - Kommentar: Calculator for volatility indicators.
      - def calculate_bb(.)
        - Kommentar: Calculate Bollinger Bands.
      - def calculate_kc(.)
        - Kommentar: Calculate Keltner Channels.
      - def calculate_atr(.)
        - Kommentar: Calculate Average True Range.
      - def calculate_natr(.)
        - Kommentar: Calculate Normalized ATR.
      - def calculate_std(.)
        - Kommentar: Calculate Standard Deviation.
    - Kommentar: Import optional libraries
  - volume.py
    - Class: VolumeIndicators
      - Kommentar: Calculator for volume indicators.
      - def calculate_obv(.)
        - Kommentar: Calculate On-Balance Volume.
      - def calculate_cmf(.)
        - Kommentar: Calculate Chaikin Money Flow.
      - def calculate_ad(.)
        - Kommentar: Calculate Accumulation/Distribution.
      - def calculate_fi(.)
        - Kommentar: Calculate Force Index.
      - def calculate_vwap(.)
        - Kommentar: Calculate VWAP.
    - Kommentar: Import optional libraries
  - __init__.py
    - Kommentar: Types
    - Kommentar: Providers
    - Kommentar: Stream Clients
  - alpaca_crypto_provider.py
    - Class: AlpacaCryptoProvider
      - Kommentar: Alpaca cryptocurrency historical data provider.
      - 
      - Uses Alpaca's Crypto Data API:
      - - Endpoint: https://data.alpaca.markets/v1beta3/crypto/us/
      - - Supported trading pairs: BTC/USD, ETH/USD, ETH/BTC, SOL/USDT, etc.
      - - Free tier: 200 API calls/minute
      - - Real-time data available via WebSocket (see AlpacaCryptoStreamClient)
      - def __init__(.)
        - Kommentar: Initialize Alpaca crypto provider.
        - 
        - Args:
        -     api_key: Alpaca API key
        -     api_secret: Alpaca API secret
      - def fetch_bars(.)
        - Kommentar: Fetch historical crypto bars from Alpaca.
        - 
        - Args:
        -     symbol: Crypto trading pair (e.g., "BTC/USD", "ETH/USD", "SOL/USDT")
        -     start_date: Start date for data
        -     end_date: End date for data
        -     timeframe: Bar timeframe
        - 
        - Returns:
        -     List of historical bars
      - def is_available(.)
        - Kommentar: Check if Alpaca crypto provider is available.
        - 
        - Returns:
        -     True if provider is available
      - def _ensure_utc_naive(.)
        - Kommentar: Convert datetime to UTC naive datetime.
        - 
        - Args:
        -     dt: Datetime to convert
        - 
        - Returns:
        -     UTC naive datetime
      - def _timeframe_to_alpaca(.)
        - Kommentar: Convert timeframe to Alpaca format.
        - 
        - Args:
        -     timeframe: Internal timeframe
        - 
        - Returns:
        -     Alpaca TimeFrame object
      - def _check_sdk(.)
        - Kommentar: Check whether the Alpaca SDK is installed.
        - 
        - Returns:
        -     True if SDK is available
  - alpaca_crypto_stream.py
    - Class: AlpacaCryptoStreamClient
      - Kommentar: Real-time cryptocurrency market data client for Alpaca using WebSocket.
      - 
      - Supports streaming of:
      - - Crypto bars (OHLCV candlesticks)
      - - Crypto trades (individual transactions)
      - - Crypto quotes (bid/ask prices)
      - - Crypto orderbooks (market depth)
      - 
      - Supported trading pairs: BTC/USD, ETH/USD, ETH/BTC, SOL/USDT, etc.
      - def __init__(.)
        - Kommentar: Initialize Alpaca crypto stream client.
        - 
        - Args:
        -     api_key: Alpaca API key
        -     api_secret: Alpaca API secret
        -     paper: Use paper trading (default: True)
        -     buffer_size: Size of the data buffer
      - def connect(.)
        - Kommentar: Connect to Alpaca Crypto WebSocket stream.
        - 
        - Returns:
        -     True if connection successful
      - def _run_stream(.)
        - Kommentar: Run the Alpaca crypto stream with automatic reconnection.
      - def disconnect(.)
        - Kommentar: Disconnect from Alpaca crypto stream.
      - def _stop_stream_sync(.)
        - Kommentar: Synchronous stream stop (runs in thread).
      - def subscribe(.)
        - Kommentar: Subscribe to crypto symbols.
        - 
        - Args:
        -     symbols: List of crypto trading pairs (e.g., ["BTC/USD", "ETH/USD"])
      - def unsubscribe(.)
        - Kommentar: Unsubscribe from crypto symbols.
        - 
        - Args:
        -     symbols: List of crypto trading pairs to unsubscribe from
      - def _unsubscribe_sync(.)
        - Kommentar: Synchronous unsubscribe (runs in thread).
      - def _on_bar(.)
        - Kommentar: Handle crypto bar (OHLCV) data.
        - 
        - Args:
        -     bar: Alpaca crypto bar object
      - def _on_trade(.)
        - Kommentar: Handle crypto trade data.
        - 
        - Args:
        -     trade: Alpaca crypto trade object
      - def _on_quote(.)
        - Kommentar: Handle crypto quote (bid/ask) data.
        - 
        - Args:
        -     quote: Alpaca crypto quote object
      - def get_latest_tick(.)
        - Kommentar: Get the latest tick for a crypto symbol.
        - 
        - Args:
        -     symbol: Crypto trading pair (e.g., "BTC/USD")
        - 
        - Returns:
        -     Latest MarketTick or None
      - def get_metrics(.)
        - Kommentar: Get crypto stream metrics.
        - 
        - Returns:
        -     Dictionary with metrics
  - alpaca_stream.py
    - Class: AlpacaStreamClient
      - Kommentar: Real-time market data client for Alpaca using WebSocket.
      - def __init__(.)
        - Kommentar: Initialize Alpaca stream client.
        - 
        - Args:
        -     api_key: Alpaca API key
        -     api_secret: Alpaca API secret
        -     paper: Use paper trading (default: True)
        -     buffer_size: Size of the data buffer
        -     feed: Data feed type - 'iex' (free, 30 symbols) or 'sip' (premium)
      - def connect(.)
        - Kommentar: Connect to Alpaca WebSocket stream.
        - 
        - Returns:
        -     True if connection successful
      - def _run_stream(.)
        - Kommentar: Run the Alpaca stream with automatic reconnection.
      - def disconnect(.)
        - Kommentar: Disconnect from Alpaca stream.
      - def _stop_stream_sync(.)
        - Kommentar: Synchronous stream stop (runs in thread).
      - def subscribe(.)
        - Kommentar: Subscribe to symbols.
        - 
        - Args:
        -     symbols: List of symbols to subscribe to
      - def unsubscribe(.)
        - Kommentar: Unsubscribe from symbols.
        - 
        - Args:
        -     symbols: List of symbols to unsubscribe from
      - def _unsubscribe_sync(.)
        - Kommentar: Synchronous unsubscribe (runs in thread).
      - def _on_bar(.)
        - Kommentar: Handle bar (OHLCV) data.
        - 
        - Args:
        -     bar: Alpaca bar object
      - def _on_trade(.)
        - Kommentar: Handle trade data.
        - 
        - Args:
        -     trade: Alpaca trade object
      - def _on_quote(.)
        - Kommentar: Handle quote (bid/ask) data.
        - 
        - Args:
        -     quote: Alpaca quote object
      - def get_latest_tick(.)
        - Kommentar: Get the latest tick for a symbol.
        - 
        - Args:
        -     symbol: Trading symbol
        - 
        - Returns:
        -     Latest MarketTick or None
      - def get_latest_bar(.)
        - Kommentar: Get the latest bar from Alpaca REST API.
        - 
        - Args:
        -     symbol: Trading symbol
        - 
        - Returns:
        -     Dictionary with bar data or None
      - def get_metrics(.)
        - Kommentar: Get stream metrics.
        - 
        - Returns:
        -     Dictionary with metrics
  - alpha_vantage_stream.py
    - Class: AlphaVantageStreamClient
      - Kommentar: Real-time market data client for Alpha Vantage using polling.
      - def __init__(.)
        - Kommentar: Initialize Alpha Vantage stream client.
        - 
        - Args:
        -     api_key: Alpha Vantage API key
        -     poll_interval: Polling interval in seconds (min 60 for free tier)
        -     buffer_size: Size of the data buffer
        -     enable_indicators: Enable real-time indicator calculations
      - def connect(.)
        - Kommentar: Start the polling loop.
        - 
        - Returns:
        -     True if connection successful
      - def disconnect(.)
        - Kommentar: Stop the polling loop.
      - def subscribe(.)
        - Kommentar: Subscribe to symbols.
        - 
        - Args:
        -     symbols: List of symbols to subscribe to
      - def unsubscribe(.)
        - Kommentar: Unsubscribe from symbols.
        - 
        - Args:
        -     symbols: List of symbols to unsubscribe from
      - def _poll_loop(.)
        - Kommentar: Main polling loop.
      - def _poll_symbol(.)
        - Kommentar: Poll data for a single symbol.
        - 
        - Args:
        -     symbol: Symbol to poll
      - def _fetch_global_quote(.)
        - Kommentar: Fetch global quote for a symbol.
        - 
        - Args:
        -     symbol: Trading symbol
        - 
        - Returns:
        -     MarketTick or None if failed
      - def _fetch_indicators(.)
        - Kommentar: Fetch technical indicators for a symbol.
        - 
        - Args:
        -     symbol: Trading symbol
      - def _fetch_rsi(.)
        - Kommentar: Fetch RSI indicator.
        - 
        - Args:
        -     symbol: Trading symbol
        -     interval: Time interval
        - 
        - Returns:
        -     Pandas Series with RSI values
      - def _fetch_macd(.)
        - Kommentar: Fetch MACD indicator.
        - 
        - Args:
        -     symbol: Trading symbol
        -     interval: Time interval
        - 
        - Returns:
        -     DataFrame with MACD values
      - def get_latest_tick(.)
        - Kommentar: Get the latest tick for a symbol.
        - 
        - Args:
        -     symbol: Trading symbol
        - 
        - Returns:
        -     Latest MarketTick or None
      - def get_metrics(.)
        - Kommentar: Get stream metrics.
        - 
        - Returns:
        -     Dictionary with metrics
  - history_provider.py
    - Class: HistoryManager
      - Kommentar: Manager for historical data with fallback support.
      - def __init__(.)
        - Kommentar: Initialize history manager.
        - 
        - Args:
        -     ibkr_adapter: Optional broker adapter for live IBKR data
      - def register_provider(.)
        - Kommentar: Register a data provider.
        - 
        - Args:
        -     source: Data source type
        -     provider: Provider instance
      - def set_ibkr_adapter(.)
        - Kommentar: Register or update the IBKR provider on-demand.
      - def _configure_priority(.)
        - Kommentar: Configure provider priority order from settings.
      - def _initialize_providers_from_config(.)
        - Kommentar: Register providers according to configuration and credentials.
      - def fetch_data(.)
        - Kommentar: Fetch historical data with fallback.
        - 
        - Args:
        -     request: Data request
        - 
        - Returns:
        -     Tuple of (bars, source_used)
      - def _store_to_database(.)
        - Kommentar: Store bars to database for caching.
      - def get_latest_price(.)
        - Kommentar: Get latest price for symbol.
      - def get_available_sources(.)
        - Kommentar: Get list of available data sources.
      - def start_realtime_stream(.)
        - Kommentar: Start real-time market data streaming.
      - def stop_realtime_stream(.)
        - Kommentar: Stop real-time market data streaming.
      - def start_crypto_realtime_stream(.)
        - Kommentar: Start real-time cryptocurrency market data streaming.
      - def stop_crypto_realtime_stream(.)
        - Kommentar: Stop real-time cryptocurrency market data streaming.
      - def get_realtime_tick(.)
        - Kommentar: Get latest real-time tick for a symbol.
      - def get_stream_metrics(.)
        - Kommentar: Get real-time stream metrics.
      - def fetch_realtime_indicators(.)
        - Kommentar: Fetch real-time technical indicators.
    - Kommentar: Import providers from new package
    - Kommentar: Re-export for backward compatibility
  - __init__.py
  - alpaca_stock_provider.py
    - Class: AlpacaProvider
      - Kommentar: Alpaca historical data provider for stocks.
      - def __init__(.)
        - Kommentar: Initialize Alpaca provider.
        - 
        - Args:
        -     api_key: Alpaca API key
        -     api_secret: Alpaca API secret
      - def fetch_bars(.)
        - Kommentar: Fetch historical bars from Alpaca.
        - 
        - Args:
        -     symbol: Trading symbol
        -     start_date: Start date for data
        -     end_date: End date for data
        -     timeframe: Bar timeframe
        - 
        - Returns:
        -     List of historical bars
      - def is_available(.)
        - Kommentar: Check if Alpaca is available.
      - def _timeframe_to_alpaca(.)
        - Kommentar: Convert timeframe to Alpaca format.
        - 
        - Args:
        -     timeframe: Internal timeframe
        - 
        - Returns:
        -     Alpaca TimeFrame object
      - def _check_sdk(.)
        - Kommentar: Check whether the Alpaca SDK is installed.
  - alpha_vantage_provider.py
    - Class: AlphaVantageProvider
      - Kommentar: Alpha Vantage historical data provider.
      - def __init__(.)
        - Kommentar: Initialize Alpha Vantage provider.
        - 
        - Args:
        -     api_key: Alpha Vantage API key
      - def fetch_bars(.)
        - Kommentar: Fetch historical bars from Alpha Vantage.
      - def is_available(.)
        - Kommentar: Check if Alpha Vantage is available.
      - def _timeframe_to_av(.)
        - Kommentar: Convert timeframe to Alpha Vantage format.
      - def fetch_technical_indicator(.)
        - Kommentar: Fetch technical indicator from Alpha Vantage.
      - def fetch_rsi(.)
        - Kommentar: Fetch RSI (Relative Strength Index) from Alpha Vantage.
      - def fetch_macd(.)
        - Kommentar: Fetch MACD from Alpha Vantage.
  - base.py
    - Class: HistoricalDataProvider
      - Kommentar: Abstract base class for historical data providers with template methods.
      - 
      - Provides common functionality for data providers:
      - - Caching support
      - - Data conversion helpers
      - - Rate limiting
      - - Template method pattern for fetch operation
      - 
      - Subclasses should implement:
      - - _fetch_data_from_source() - provider-specific data fetching
      - - is_available() - check provider availability
      - def __init__(.)
        - Kommentar: Initialize provider.
        - 
        - Args:
        -     name: Provider name
        -     enable_cache: Enable response caching
      - def fetch_bars(.)
        - Kommentar: Fetch historical bars.
        - 
        - Args:
        -     symbol: Trading symbol
        -     start_date: Start date for data
        -     end_date: End date for data
        -     timeframe: Bar timeframe
        - 
        - Returns:
        -     List of historical bars
      - def is_available(.)
        - Kommentar: Check if provider is available.
        - 
        - Returns:
        -     True if provider is available
      - def fetch_bars_with_cache(.)
        - Kommentar: Fetch bars with caching support (template method).
        - 
        - This provides a standard fetch pattern:
        - 1. Check cache
        - 2. Fetch from source if not cached
        - 3. Convert to bars
        - 4. Cache results
        - 
        - Args:
        -     symbol: Trading symbol
        -     start_date: Start date
        -     end_date: End date
        -     timeframe: Timeframe
        - 
        - Returns:
        -     List of historical bars
      - def _fetch_data_from_source(.)
        - Kommentar: Fetch data from provider source.
        - 
        - Subclasses should implement this to provide provider-specific logic
        - when using the fetch_bars_with_cache template method.
        - 
        - Args:
        -     symbol: Trading symbol
        -     start_date: Start date
        -     end_date: End date
        -     timeframe: Timeframe
        - 
        - Returns:
        -     DataFrame with OHLCV data and timestamp index
        - 
        - Raises:
        -     NotImplementedError: If not implemented by subclass
      - def _cache_key(.)
        - Kommentar: Generate cache key.
        - 
        - Args:
        -     symbol: Trading symbol
        -     start_date: Start date
        -     end_date: End date
        -     timeframe: Timeframe
        - 
        - Returns:
        -     Cache key string
      - def _df_to_bars(.)
        - Kommentar: Convert DataFrame to HistoricalBar list.
        - 
        - Standard conversion method shared across all providers.
        - 
        - Args:
        -     df: DataFrame with OHLCV data and timestamp index
        - 
        - Returns:
        -     List of HistoricalBar objects
      - def _to_unix_timestamp(.)
        - Kommentar: Convert datetime to UTC UNIX timestamp.
        - 
        - Args:
        -     dt: Datetime to convert
        - 
        - Returns:
        -     UNIX timestamp as integer
      - def _clamp_date_range(.)
        - Kommentar: Clamp date range to provider limits.
        - 
        - Args:
        -     requested_start: Requested start date
        -     requested_end: Requested end date
        -     max_lookback_days: Maximum lookback in days (None for unlimited)
        - 
        - Returns:
        -     Tuple of (clamped_start, clamped_end)
  - database_provider.py
    - Class: DatabaseProvider
      - Kommentar: Database historical data provider (local cache).
      - def __init__(.)
        - Kommentar: Initialize database provider.
      - def fetch_bars(.)
        - Kommentar: Fetch historical bars from database.
      - def _fetch_bars_sync(.)
        - Kommentar: Synchronous database fetch (runs in thread).
      - def is_available(.)
        - Kommentar: Check if database is available.
      - def _resample_bars(.)
        - Kommentar: Resample bars to different timeframe.
  - finnhub_provider.py
    - Class: FinnhubProvider
      - Kommentar: Finnhub historical data provider.
      - def __init__(.)
        - Kommentar: Initialize Finnhub provider.
        - 
        - Args:
        -     api_key: Finnhub API key
      - def fetch_bars(.)
        - Kommentar: Fetch historical bars from Finnhub.
      - def is_available(.)
        - Kommentar: Check if Finnhub is available.
      - def _timeframe_to_finnhub(.)
        - Kommentar: Convert timeframe to Finnhub format.
  - ibkr_provider.py
    - Class: IBKRHistoricalProvider
      - Kommentar: IBKR historical data provider.
      - def __init__(.)
        - Kommentar: Initialize IBKR provider.
        - 
        - Args:
        -     ibkr_adapter: IBKR broker adapter instance
      - def fetch_bars(.)
        - Kommentar: Fetch historical bars from IBKR.
      - def is_available(.)
        - Kommentar: Check if IBKR is available.
      - def _calculate_duration(.)
        - Kommentar: Calculate IBKR duration string.
      - def _timeframe_to_ibkr(.)
        - Kommentar: Convert timeframe to IBKR format.
  - yahoo_provider.py
    - Class: YahooFinanceProvider
      - Kommentar: Yahoo Finance historical data provider.
      - def __init__(.)
      - def fetch_bars(.)
        - Kommentar: Fetch historical bars from Yahoo Finance.
      - def is_available(.)
        - Kommentar: Yahoo Finance is always available (no API key required).
      - def _timeframe_to_yahoo(.)
        - Kommentar: Convert timeframe enum to Yahoo Finance interval string.
      - def _to_unix(.)
        - Kommentar: Convert datetime to UTC UNIX timestamp.
      - def _clamp_date_range_yahoo(.)
        - Kommentar: Ensure Yahoo intraday requests stay within supported lookback windows.
      - def _get_lookback_limit(.)
        - Kommentar: Return maximum supported lookback window for a timeframe.
  - stream_client.py
    - Class: StreamStatus
      - Kommentar: Stream connection status.
    - Class: StreamMetrics
      - Kommentar: Metrics for stream performance.
      - def update_latency(.)
        - Kommentar: Update average latency.
    - Class: MarketTick
      - Kommentar: Market data tick.
    - Class: StreamClient
      - Kommentar: Base class for market data stream clients.
      - def __init__(.)
        - Kommentar: Initialize stream client.
        - 
        - Args:
        -     name: Client name
        -     buffer_size: Size of the data buffer
        -     heartbeat_interval: Heartbeat interval in seconds
        -     reconnect_attempts: Maximum reconnection attempts
        -     max_lag_ms: Maximum acceptable lag in milliseconds
      - def connect(.)
        - Kommentar: Connect to data stream.
      - def disconnect(.)
        - Kommentar: Disconnect from data stream.
      - def subscribe(.)
        - Kommentar: Subscribe to market data for symbols.
        - 
        - Args:
        -     symbols: List of symbols to subscribe to
        -     callback: Optional callback for data updates
      - def unsubscribe(.)
        - Kommentar: Unsubscribe from market data.
        - 
        - Args:
        -     symbols: List of symbols to unsubscribe from
      - def _handle_subscription(.)
        - Kommentar: Handle subscription request (override in subclass).
      - def _handle_unsubscription(.)
        - Kommentar: Handle unsubscription request (override in subclass).
      - def process_tick(.)
        - Kommentar: Process incoming market tick.
        - 
        - Args:
        -     tick: Market data tick
      - def _safe_callback(.)
        - Kommentar: Safely execute callback.
        - 
        - Args:
        -     callback: Callback function
        -     tick: Market tick data
      - def _heartbeat_loop(.)
        - Kommentar: Send periodic heartbeats to keep connection alive.
      - def _send_heartbeat(.)
        - Kommentar: Send heartbeat (override in subclass).
      - def _reconnect(.)
        - Kommentar: Reconnect with exponential backoff.
      - def _process_buffer(.)
        - Kommentar: Process buffered data in batches.
      - def _process_batch(.)
        - Kommentar: Process a batch of market ticks.
        - 
        - Args:
        -     batch: List of market ticks
      - def _tick_to_dict(.)
        - Kommentar: Convert tick to dictionary.
        - 
        - Args:
        -     tick: Market tick
        - 
        - Returns:
        -     Dictionary representation
      - def _store_ticks(.)
        - Kommentar: Store ticks in database.
        - 
        - Args:
        -     ticks: List of market ticks
      - def get_latest_tick(.)
        - Kommentar: Get latest tick for symbol.
        - 
        - Args:
        -     symbol: Trading symbol
        - 
        - Returns:
        -     Latest market tick or None
      - def get_metrics(.)
        - Kommentar: Get stream metrics.
        - 
        - Returns:
        -     Metrics dictionary
    - Class: IBKRStreamClient
      - Kommentar: IBKR-specific stream client implementation.
      - def __init__(.)
        - Kommentar: Initialize IBKR stream client.
        - 
        - Args:
        -     ibkr_client: IBKR API client instance
      - def connect(.)
        - Kommentar: Connect to IBKR data stream.
      - def _handle_subscription(.)
        - Kommentar: Handle subscription to IBKR market data.
      - def _get_next_req_id(.)
        - Kommentar: Get next request ID.
    - Class: TradeRepublicStreamClient
      - Kommentar: Trade Republic-specific stream client implementation.
      - def __init__(.)
        - Kommentar: Initialize Trade Republic stream client.
        - 
        - Args:
        -     ws_connection: WebSocket connection
      - def connect(.)
        - Kommentar: Connect to Trade Republic data stream.
      - def _listen(.)
        - Kommentar: Listen for WebSocket messages.
      - def _handle_message(.)
        - Kommentar: Handle incoming WebSocket message.
      - def _handle_subscription(.)
        - Kommentar: Handle subscription to Trade Republic market data.
      - def _send_heartbeat(.)
        - Kommentar: Send heartbeat to Trade Republic.
  - types.py
    - Class: AssetClass
      - Kommentar: Asset class types supported by the platform.
    - Class: DataSource
      - Kommentar: Available data sources.
    - Class: Timeframe
      - Kommentar: Market data timeframes.
    - Class: HistoricalBar
      - Kommentar: Historical market bar data.
    - Class: DataRequest
      - Kommentar: Request for historical data.
  - __init__.py
  - backtest_models.py
    - Class: TradeSide
      - Kommentar: Trade direction.
    - Class: Bar
      - Kommentar: OHLCV bar data.
      - 
      - Represents a single candlestick/bar with price and volume information.
    - Class: Trade
      - Kommentar: Represents a completed or active trade.
      - 
      - Captures all relevant information about a trade including entry/exit,
      - P&L, risk management levels, and reasoning.
      - def duration(.)
        - Kommentar: Trade duration in seconds.
      - def r_multiple(.)
        - Kommentar: Risk-reward multiple (R-multiple).
        - 
        - Returns how many times the initial risk was gained/lost.
      - def is_winner(.)
        - Kommentar: Check if trade was profitable.
    - Class: EquityPoint
      - Kommentar: Point on the equity curve.
      - 
      - Represents account equity at a specific point in time.
    - Class: BacktestMetrics
      - Kommentar: Comprehensive backtest performance metrics.
      - 
      - Provides statistical analysis of backtest results including
      - profitability, risk, and trading efficiency metrics.
      - def recovery_factor(.)
        - Kommentar: Recovery factor: Net profit / Max drawdown.
    - Class: BacktestResult
      - Kommentar: Complete backtest result with all data and metrics.
      - 
      - Consolidates all information from a backtest run including market data,
      - trades, equity curve, indicators, and performance metrics.
      - def duration_days(.)
        - Kommentar: Backtest duration in days.
      - def total_pnl(.)
        - Kommentar: Total profit/loss.
      - def total_pnl_pct(.)
        - Kommentar: Total return percentage.
    - def from_historical_bar(.)
      - Kommentar: Convert HistoricalBar (from market_data.types) to Bar.
      - 
      - Args:
      -     bar: HistoricalBar instance from history provider
      -     symbol: Optional symbol override
      - 
      - Returns:
      -     Bar instance
    - def to_historical_bars(.)
      - Kommentar: Convert Bar list to HistoricalBar list.
      - 
      - Args:
      -     bars: List of Bar instances
      -     symbol: Symbol for the bars
      - 
      - Returns:
      -     List of HistoricalBar instances
  - __init__.py
    - Kommentar: Enums
    - Kommentar: Models
    - Kommentar: Type Aliases
    - Kommentar: Compiler
  - compiled_strategy.py
    - Class: CompiledStrategy
      - Kommentar: Dynamically compiled strategy from StrategyDefinition.
      - def __init__(.)
        - Kommentar: Initialize strategy with definition.
        - 
        - Args:
        -     definition: Strategy definition containing rules and indicators
      - def _setup_indicators(.)
        - Kommentar: Create and setup all indicators.
      - def _setup_evaluators(.)
        - Kommentar: Setup condition evaluators for entry/exit signals.
      - def _setup_risk_management(.)
        - Kommentar: Setup risk management configuration.
      - def next(.)
        - Kommentar: Execute strategy logic on each bar.
      - def _check_entry_signals(.)
        - Kommentar: Check for entry signals when no position exists.
      - def _check_exit_signals(.)
        - Kommentar: Check for exit signals when position exists.
      - def _enter_long(.)
        - Kommentar: Enter long position.
      - def _enter_short(.)
        - Kommentar: Enter short position.
      - def _exit_position(.)
        - Kommentar: Exit current position.
      - def _check_risk_management(.)
        - Kommentar: Check stop loss and take profit conditions.
      - def _calculate_pnl_percentage(.)
        - Kommentar: Calculate P&L percentage based on position direction.
      - def _check_stop_loss(.)
        - Kommentar: Check stop loss conditions. Returns True if position was closed.
      - def _check_take_profit(.)
        - Kommentar: Check take profit conditions.
      - def notify_order(.)
        - Kommentar: Handle order notifications.
  - compiler.py
    - Class: CompilationError
      - Kommentar: Exception raised when strategy compilation fails.
    - Class: IndicatorFactory
      - Kommentar: Factory for creating Backtrader indicators from IndicatorConfig.
      - 
      - Maps IndicatorType enum to Backtrader indicator classes.
      - def create_indicator(.)
        - Kommentar: Create Backtrader indicator from configuration.
        - 
        - Args:
        -     config: Indicator configuration
        -     data: Backtrader data feed
        - 
        - Returns:
        -     Instantiated Backtrader indicator
        - 
        - Raises:
        -     CompilationError: If indicator type is not supported
      - def _normalize_params(.)
        - Kommentar: Normalize parameter names for different indicators.
        - 
        - Args:
        -     indicator_type: Type of indicator
        -     params: Raw parameters from config
        - 
        - Returns:
        -     Normalized parameters for Backtrader
    - Class: ConditionEvaluator
      - Kommentar: Evaluates Condition and LogicGroup expressions.
      - 
      - Recursively evaluates nested logic groups and handles special operators
      - like crosses_above, crosses_below, inside, outside.
      - def __init__(.)
        - Kommentar: Initialize evaluator.
        - 
        - Args:
        -     strategy: Backtrader strategy instance (for accessing indicators)
      - def evaluate(.)
        - Kommentar: Evaluate condition or logic group.
        - 
        - Args:
        -     logic: Condition or LogicGroup to evaluate
        - 
        - Returns:
        -     Boolean result of evaluation
      - def _evaluate_condition(.)
        - Kommentar: Evaluate a single condition.
        - 
        - Args:
        -     cond: Condition to evaluate
        - 
        - Returns:
        -     Boolean result
      - def _evaluate_logic_group(.)
        - Kommentar: Evaluate a logic group (AND, OR, NOT).
        - 
        - Args:
        -     group: LogicGroup to evaluate
        - 
        - Returns:
        -     Boolean result
      - def _resolve_operand(.)
        - Kommentar: Resolve operand to a numeric value.
        - 
        - Args:
        -     operand: Indicator alias or numeric literal
        - 
        - Returns:
        -     Numeric value
        - 
        - Raises:
        -     CompilationError: If operand cannot be resolved
      - def _check_cross_above(.)
        - Kommentar: Check if left crossed above right.
        - 
        - Args:
        -     key: Unique key for tracking (usually left operand)
        -     current_left: Current left value
        -     current_right: Current right value
        - 
        - Returns:
        -     True if crossed above, False otherwise
      - def _check_cross_below(.)
        - Kommentar: Check if left crossed below right.
        - 
        - Args:
        -     key: Unique key for tracking (usually left operand)
        -     current_left: Current left value
        -     current_right: Current right value
        - 
        - Returns:
        -     True if crossed below, False otherwise
    - Class: StrategyCompiler
      - Kommentar: Compiles StrategyDefinition into executable Backtrader strategies.
      - 
      - Creates a dynamic Backtrader Strategy class at runtime based on the
      - declarative strategy definition.
      - 
      - Example:
      -     >>> compiler = StrategyCompiler()
      -     >>> strategy_class = compiler.compile(strategy_definition)
      -     >>> cerebro.addstrategy(strategy_class)
      - def compile(.)
        - Kommentar: Compile strategy definition to Backtrader Strategy class.
        - 
        - Args:
        -     definition: Validated strategy definition
        - 
        - Returns:
        -     Backtrader Strategy class (not instance)
        - 
        - Raises:
        -     CompilationError: If compilation fails
      - def _create_strategy_class(.)
        - Kommentar: Create dynamic Backtrader Strategy class.
        - 
        - Args:
        -     definition: Strategy definition
        - 
        - Returns:
        -     Strategy class configured with definition
  - definition.py
    - Class: IndicatorType
      - Kommentar: Supported technical indicator types.
    - Class: ComparisonOperator
      - Kommentar: Comparison operators for conditions.
    - Class: LogicOperator
      - Kommentar: Logic operators for combining conditions.
    - Class: IndicatorConfig
      - Kommentar: Configuration for a technical indicator.
      - 
      - Attributes:
      -     type: Indicator type (SMA, RSI, MACD, etc.)
      -     params: Indicator-specific parameters (e.g., period, deviation)
      -     alias: Unique identifier for referencing in conditions
      -     source: Data source field (default: "close")
      -     plot: Whether to plot this indicator in charts
      - 
      - Example:
      -     >>> IndicatorConfig(
      -     ...     type="SMA",
      -     ...     params={"period": 20},
      -     ...     alias="sma_fast",
      -     ...     source="close"
      -     ... )
      - def validate_alias(.)
        - Kommentar: Validate alias format (alphanumeric + underscore).
    - Class: Condition
      - Kommentar: Single condition for strategy logic.
      - 
      - Attributes:
      -     type: Discriminator field (always "condition")
      -     left: Left operand (indicator alias or numeric value)
      -     operator: Comparison operator
      -     right: Right operand (indicator alias or numeric value)
      -     description: Optional human-readable description
      - 
      - Example:
      -     >>> Condition(
      -     ...     left="sma_fast",
      -     ...     operator="crosses_above",
      -     ...     right="sma_slow",
      -     ...     description="Fast SMA crosses above slow SMA"
      -     ... )
      - def validate_range_operators(.)
        - Kommentar: Validate that range operators have list[float] as right operand.
    - Class: LogicGroup
      - Kommentar: Group of conditions combined with logic operators.
      - 
      - Supports recursive nesting for complex logic like:
      - (A AND B) OR (C AND D)
      - 
      - Attributes:
      -     type: Discriminator field (always "group")
      -     operator: Logic operator (AND, OR, NOT)
      -     conditions: List of conditions or nested logic groups
      -     description: Optional human-readable description
      - 
      - Example:
      -     >>> LogicGroup(
      -     ...     operator="AND",
      -     ...     conditions=[
      -     ...         Condition(left="rsi", operator="<", right=30),
      -     ...         Condition(left="sma_fast", operator=">", right="sma_slow")
      -     ...     ],
      -     ...     description="RSI oversold AND bullish crossover"
      -     ... )
      - def validate_conditions_not_empty(.)
        - Kommentar: Validate that conditions list is not empty.
      - def validate_not_operator(.)
        - Kommentar: Validate that NOT operator has exactly one condition.
    - Class: RiskManagement
      - Kommentar: Risk management parameters for the strategy.
      - 
      - Attributes:
      -     stop_loss_pct: Stop loss as percentage of entry price
      -     take_profit_pct: Take profit as percentage of entry price
      -     stop_loss_atr: Stop loss as multiple of ATR
      -     take_profit_atr: Take profit as multiple of ATR
      -     trailing_stop_pct: Trailing stop as percentage
      -     max_position_size_pct: Max position size as % of capital
      -     max_risk_per_trade_pct: Max risk per trade as % of capital
      - 
      - Example:
      -     >>> RiskManagement(
      -     ...     stop_loss_pct=2.0,
      -     ...     take_profit_pct=5.0,
      -     ...     max_risk_per_trade_pct=1.0
      -     ... )
      - def validate_stop_loss_methods(.)
        - Kommentar: Validate that only one stop loss method is used.
      - def validate_take_profit_methods(.)
        - Kommentar: Validate that only one take profit method is used.
    - Class: StrategyDefinition
      - Kommentar: Complete trading strategy definition.
      - 
      - Attributes:
      -     name: Strategy name
      -     version: Strategy version (semantic versioning)
      -     description: Strategy description
      -     indicators: List of indicator configurations
      -     entry_long: Entry condition for long positions
      -     exit_long: Exit condition for long positions
      -     entry_short: Entry condition for short positions (optional)
      -     exit_short: Exit condition for short positions (optional)
      -     risk_management: Risk management parameters
      -     meta: Additional metadata (tags, author, etc.)
      - 
      - Example:
      -     >>> strategy = StrategyDefinition(
      -     ...     name="SMA Crossover",
      -     ...     version="1.0.0",
      -     ...     indicators=[
      -     ...         IndicatorConfig(type="SMA", params={"period": 20}, alias="sma_fast"),
      -     ...         IndicatorConfig(type="SMA", params={"period": 50}, alias="sma_slow")
      -     ...     ],
      -     ...     entry_long=Condition(
      -     ...         left="sma_fast", operator="crosses_above", right="sma_slow"
      -     ...     ),
      -     ...     exit_long=Condition(
      -     ...         left="sma_fast", operator="crosses_below", right="sma_slow"
      -     ...     ),
      -     ...     risk_management=RiskManagement(
      -     ...         stop_loss_pct=2.0,
      -     ...         take_profit_pct=5.0
      -     ...     )
      -     ... )
      - def validate_unique_aliases(.)
        - Kommentar: Validate that all indicator aliases are unique.
      - def validate_condition_references(.)
        - Kommentar: Validate that all condition references point to valid indicators.
      - def get_indicator_by_alias(.)
        - Kommentar: Get indicator configuration by alias.
        - 
        - Args:
        -     alias: Indicator alias
        - 
        - Returns:
        -     IndicatorConfig or None if not found
      - def to_yaml(.)
        - Kommentar: Export strategy definition as YAML string.
        - 
        - Returns:
        -     YAML representation of the strategy
      - def from_yaml(.)
        - Kommentar: Load strategy definition from YAML string.
        - 
        - Args:
        -     yaml_str: YAML string
        - 
        - Returns:
        -     StrategyDefinition instance
      - def to_json_file(.)
        - Kommentar: Save strategy definition to JSON file.
        - 
        - Args:
        -     filepath: Path to JSON file
      - def from_json_file(.)
        - Kommentar: Load strategy definition from JSON file.
        - 
        - Args:
        -     filepath: Path to JSON file
        - 
        - Returns:
        -     StrategyDefinition instance
    - def _get_condition_type(.)
      - Kommentar: Get discriminator value for Condition | LogicGroup union.
    - Kommentar: Type alias for entry/exit logic with discriminator
    - Kommentar: Type aliases for convenience
  - engine.py
    - Class: SignalType
      - Kommentar: Types of trading signals.
    - Class: StrategyType
      - Kommentar: Types of trading strategies.
    - Class: Signal
      - Kommentar: Trading signal generated by strategy.
    - Class: StrategyConfig
      - Kommentar: Configuration for a trading strategy.
    - Class: StrategyState
      - Kommentar: Current state of a strategy.
    - Class: BaseStrategy
      - Kommentar: Abstract base class for trading strategies.
      - def __init__(.)
        - Kommentar: Initialize strategy.
        - 
        - Args:
        -     config: Strategy configuration
        -     indicator_engine: Indicator calculation engine
      - def evaluate(.)
        - Kommentar: Evaluate strategy and generate signal.
        - 
        - Args:
        -     data: Market data (OHLCV)
        - 
        - Returns:
        -     Trading signal or None
      - def update_position(.)
        - Kommentar: Update position tracking.
        - 
        - Args:
        -     symbol: Trading symbol
        -     quantity: Position quantity (negative for short)
      - def get_position(.)
        - Kommentar: Get current position.
        - 
        - Args:
        -     symbol: Trading symbol
        - 
        - Returns:
        -     Position quantity (0 if no position)
      - def has_position(.)
        - Kommentar: Check if strategy has position.
        - 
        - Args:
        -     symbol: Trading symbol
        - 
        - Returns:
        -     True if has position
      - def calculate_position_size(.)
        - Kommentar: Calculate position size.
        - 
        - Args:
        -     symbol: Trading symbol
        -     signal_confidence: Signal confidence (0-1)
        -     account_equity: Total account equity
        -     current_price: Current price
        - 
        - Returns:
        -     Position size in shares
    - Class: StrategyEngine
      - Kommentar: Engine for managing multiple trading strategies.
      - def __init__(.)
        - Kommentar: Initialize strategy engine.
      - def create_strategy(.)
        - Kommentar: Create a strategy instance.
        - 
        - Args:
        -     config: Strategy configuration
        - 
        - Returns:
        -     Strategy instance
      - def enable_strategy(.)
        - Kommentar: Enable a strategy.
        - 
        - Args:
        -     name: Strategy name
      - def disable_strategy(.)
        - Kommentar: Disable a strategy.
        - 
        - Args:
        -     name: Strategy name
      - def evaluate_all(.)
        - Kommentar: Evaluate all active strategies.
        - 
        - Args:
        -     market_data: Market data by symbol
        - 
        - Returns:
        -     List of generated signals
      - def combine_signals(.)
        - Kommentar: Combine multiple signals into consensus.
        - 
        - Args:
        -     signals: List of signals
        - 
        - Returns:
        -     Combined signal or None
      - def get_strategy_stats(.)
        - Kommentar: Get strategy statistics.
        - 
        - Args:
        -     name: Strategy name
        - 
        - Returns:
        -     Strategy statistics
      - def signal_to_order(.)
        - Kommentar: Convert signal to order request.
        - 
        - Args:
        -     signal: Trading signal
        - 
        - Returns:
        -     Order request
  - evaluation.py
    - Class: ConditionEvaluator
      - Kommentar: Evaluates trading strategy conditions.
      - def __init__(.)
        - Kommentar: Initialize evaluator with strategy context.
        - 
        - Args:
        -     strategy: Backtrader strategy instance
      - def evaluate(.)
        - Kommentar: Evaluate a condition.
        - 
        - Args:
        -     condition: Condition to evaluate
        - 
        - Returns:
        -     Boolean result of evaluation
        - 
        - Raises:
        -     CompilationError: If evaluation fails
      - def _evaluate_comparison(.)
        - Kommentar: Evaluate a comparison condition.
        - 
        - Args:
        -     cond: Comparison condition to evaluate
        - 
        - Returns:
        -     Boolean result
      - def _apply_comparison_operator(.)
        - Kommentar: Apply comparison operator to values.
      - def _evaluate_logic_group(.)
        - Kommentar: Evaluate a logic group (AND, OR, NOT).
        - 
        - Args:
        -     group: LogicGroup to evaluate
        - 
        - Returns:
        -     Boolean result
      - def _resolve_operand(.)
        - Kommentar: Resolve operand to a numeric value.
        - 
        - Args:
        -     operand: Indicator alias or numeric literal
        - 
        - Returns:
        -     Numeric value
        - 
        - Raises:
        -     CompilationError: If operand cannot be resolved
      - def _is_numeric_string(.)
        - Kommentar: Check if string represents a number.
      - def _resolve_data_field(.)
        - Kommentar: Resolve data field (close, open, high, low, volume).
      - def _resolve_indicator(.)
        - Kommentar: Resolve indicator value by alias.
      - def _check_cross_above(.)
        - Kommentar: Check if operand crossed above threshold.
        - 
        - Args:
        -     operand: Operand key for tracking
        -     current_value: Current value
        -     threshold: Threshold value
        - 
        - Returns:
        -     True if crossed above
      - def _check_cross_below(.)
        - Kommentar: Check if operand crossed below threshold.
        - 
        - Args:
        -     operand: Operand key for tracking
        -     current_value: Current value
        -     threshold: Threshold value
        - 
        - Returns:
        -     True if crossed below
      - def _get_previous_value(.)
        - Kommentar: Get previous value for operand.
      - def _update_previous_value(.)
        - Kommentar: Update previous value for operand.
  - loader.py
    - Class: StrategyLoader
      - Kommentar: Loads and manages strategy definitions from YAML files.
      - def __init__(.)
        - Kommentar: Initialize strategy loader.
        - 
        - Args:
        -     strategy_dirs: List of directories to search for strategies.
        -                   Defaults to examples/strategies and config/strategies.
      - def discover_strategies(.)
        - Kommentar: Discover all available strategy YAML files.
        - 
        - Returns:
        -     List of strategy names
      - def load_strategy(.)
        - Kommentar: Load a strategy by name.
        - 
        - Args:
        -     name: Strategy name (filename without .yaml extension)
        - 
        - Returns:
        -     StrategyDefinition if found, None otherwise
      - def load_all_strategies(.)
        - Kommentar: Load all discovered strategies.
        - 
        - Returns:
        -     Dictionary of strategy name -> StrategyDefinition
      - def get_strategy_info(.)
        - Kommentar: Get metadata about a strategy without fully loading it.
        - 
        - Args:
        -     name: Strategy name
        - 
        - Returns:
        -     Dictionary with strategy metadata (name, version, description, etc.)
    - def get_strategy_loader(.)
      - Kommentar: Get the global strategy loader instance.
      - 
      - Returns:
      -     StrategyLoader singleton
    - Kommentar: Global strategy loader instance
  - __init__.py
  - breakout.py
    - Class: BreakoutStrategy
      - Kommentar: Breakout strategy using support/resistance and volume.
      - def evaluate(.)
        - Kommentar: Evaluate breakout strategy.
  - mean_reversion.py
    - Class: MeanReversionStrategy
      - Kommentar: Mean reversion strategy using Bollinger Bands.
      - def evaluate(.)
        - Kommentar: Evaluate mean reversion strategy.
  - momentum.py
    - Class: MomentumStrategy
      - Kommentar: Momentum strategy using rate of change and volume.
      - def evaluate(.)
        - Kommentar: Evaluate momentum strategy.
  - scalping.py
    - Class: ScalpingStrategy
      - Kommentar: High-frequency scalping strategy.
      - def evaluate(.)
        - Kommentar: Evaluate scalping strategy.
  - trend_following.py
    - Class: TrendFollowingStrategy
      - Kommentar: Trend following strategy using moving averages.
      - def evaluate(.)
        - Kommentar: Evaluate trend following strategy.
  - __init__.py
    - Kommentar: Models
    - Kommentar: Database Manager
  - database.py
    - Class: DatabaseManager
      - Kommentar: Manages database connections and operations.
      - def __init__(.)
        - Kommentar: Initialize the database manager.
        - 
        - Args:
        -     config: Database configuration
      - def initialize(.)
        - Kommentar: Initialize the database connection and create tables.
      - def create_tables(.)
        - Kommentar: Create all database tables.
      - def _create_timescale_hypertables(.)
        - Kommentar: Create TimescaleDB hypertables for time-series data.
      - def drop_tables(.)
        - Kommentar: Drop all database tables. USE WITH CAUTION!
      - def session(.)
        - Kommentar: Provide a transactional scope for database operations.
        - 
        - Yields:
        -     Database session
        - 
        - Example:
        -     with db_manager.session() as session:
        -         session.add(order)
        -         session.commit()
      - def get_session(.)
        - Kommentar: Get a new database session.
        - 
        - Returns:
        -     Database session
        - 
        - Note:
        -     Caller is responsible for closing the session.
      - def execute_raw(.)
        - Kommentar: Execute a raw SQL query.
        - 
        - Args:
        -     query: SQL query string
        -     params: Query parameters
        - 
        - Returns:
        -     Query result
      - def backup(.)
        - Kommentar: Create a database backup (SQLite only).
        - 
        - Args:
        -     backup_path: Path to save the backup
      - def vacuum(.)
        - Kommentar: Perform database maintenance (VACUUM for SQLite).
      - def get_table_stats(.)
        - Kommentar: Get statistics about database tables.
        - 
        - Returns:
        -     Dictionary with table names and row counts
      - def cleanup_old_data(.)
        - Kommentar: Clean up old data from the database.
        - 
        - Args:
        -     days_to_keep: Number of days of data to keep
      - def close(.)
        - Kommentar: Close the database connection.
    - def initialize_database(.)
      - Kommentar: Initialize the global database manager.
      - 
      - Args:
      -     config: Database configuration
      - 
      - Returns:
      -     Initialized database manager
    - def get_db_manager(.)
      - Kommentar: Get the global database manager.
      - 
      - Returns:
      -     Database manager instance
      - 
      - Raises:
      -     RuntimeError: If database not initialized
    - Kommentar: Global database manager instance
  - models.py
    - Class: OrderStatus
      - Kommentar: Order status enumeration.
    - Class: OrderSide
      - Kommentar: Order side (buy/sell).
    - Class: OrderType
      - Kommentar: Order type enumeration.
    - Class: TimeInForce
      - Kommentar: Time in force for orders.
    - Class: AlertPriority
      - Kommentar: Alert priority levels.
    - Class: MarketBar
      - Kommentar: 1-second market data bars.
    - Class: Order
      - Kommentar: Trading orders.
    - Class: Execution
      - Kommentar: Order executions/fills.
    - Class: Position
      - Kommentar: Current positions.
    - Class: Alert
      - Kommentar: Trading alerts and notifications.
    - Class: Strategy
      - Kommentar: Strategy configurations and parameters.
    - Class: BacktestResult
      - Kommentar: Backtesting results.
    - Class: AITelemetry
      - Kommentar: AI API usage telemetry and cost tracking.
    - Class: AICache
      - Kommentar: Cache for AI responses to reduce API calls.
    - Class: AuditLog
      - Kommentar: Comprehensive audit trail for all trading activities.
    - Class: SystemMetrics
      - Kommentar: System performance and health metrics.
  - __init__.py
  - app.py
    - Class: TradingApplication
      - Kommentar: Main application window for OrderPilot-AI.
      - def __init__(.)
      - def init_ui(.)
        - Kommentar: Initialize the user interface.
      - def create_central_widget(.)
        - Kommentar: Create the central widget with tabs.
      - def create_dock_widgets(.)
        - Kommentar: Create dock widgets for additional panels.
      - def create_status_bar(.)
        - Kommentar: Create the status bar.
      - def setup_event_handlers(.)
        - Kommentar: Setup event bus handlers.
      - def _on_market_data_error_event(.)
        - Kommentar: Handle market data error from background thread.
      - def _show_market_data_error_popup(.)
        - Kommentar: Show error popup in main thread (thread-safe).
      - def setup_timers(.)
        - Kommentar: Setup update timers.
      - def initialize_services(.)
        - Kommentar: Initialize application services.
      - def apply_theme(.)
        - Kommentar: Apply a theme to the application.
      - def load_settings(.)
        - Kommentar: Load application settings.
      - def save_settings(.)
        - Kommentar: Save application settings.
      - def show_order_dialog(.)
        - Kommentar: Show the order placement dialog.
      - def show_settings_dialog(.)
        - Kommentar: Show the settings dialog.
      - def show_backtest_dialog(.)
        - Kommentar: Show the backtest dialog.
      - def show_ai_backtest_dialog(.)
        - Kommentar: Show the AI-powered backtest analysis dialog.
      - def show_parameter_optimization_dialog(.)
        - Kommentar: Show the parameter optimization dialog.
      - def show_ai_monitor(.)
        - Kommentar: Show AI usage monitor.
      - def reset_toolbars_and_docks(.)
        - Kommentar: Reset all toolbars and dock widgets to their default positions.
      - def show_about(.)
        - Kommentar: Show about dialog.
      - def open_chart_popup(.)
        - Kommentar: Open a popup chart window for the symbol.
      - def on_watchlist_symbol_added(.)
        - Kommentar: Handle symbol added to watchlist.
      - def on_order_placed(.)
        - Kommentar: Handle order placement.
      - def on_broker_connected(.)
        - Kommentar: Handle broker connection event.
      - def on_broker_disconnected(.)
        - Kommentar: Handle broker disconnection event.
      - def on_order_filled(.)
        - Kommentar: Handle order fill event.
      - def on_alert_triggered(.)
        - Kommentar: Handle alert trigger event.
      - def update_time(.)
        - Kommentar: Update time display.
      - def update_dashboard(.)
        - Kommentar: Update dashboard with latest data.
      - def update_account_info(.)
        - Kommentar: Update account information display.
      - def on_data_provider_changed(.)
        - Kommentar: Handle market data provider change.
      - def refresh_market_data(.)
        - Kommentar: Refresh market data for all visible widgets.
      - def closeEvent(.)
        - Kommentar: Handle application close event.
    - def main(.)
      - Kommentar: Main application entry point.
    - Kommentar: qasync for asyncio integration
    - Kommentar: PyQt6 imports
    - Kommentar: Application imports
    - Kommentar: UI component imports
  - __init__.py
  - broker_mixin.py
    - Class: BrokerMixin
      - Kommentar: Mixin providing broker connection functionality for TradingApplication.
      - def connect_broker(.)
        - Kommentar: Connect to the selected broker.
      - def disconnect_broker(.)
        - Kommentar: Disconnect from the broker.
      - def _on_trading_mode_changed(.)
        - Kommentar: Handle trading mode changes.
      - def initialize_realtime_streaming(.)
        - Kommentar: Initialize real-time market data streaming.
      - def _is_crypto_symbol(.)
        - Kommentar: Check if symbol is a cryptocurrency pair.
      - def toggle_live_data(.)
        - Kommentar: Toggle live market data on/off.
      - def analyze_order_with_ai(.)
        - Kommentar: AI hook for order analysis.
      - def _subscribe_symbol_to_stream(.)
        - Kommentar: Subscribe a symbol to the appropriate real-time stream.
  - menu_mixin.py
    - Class: MenuMixin
      - Kommentar: Mixin providing menu bar functionality for TradingApplication.
      - def create_menu_bar(.)
        - Kommentar: Create the application menu bar.
  - toolbar_mixin.py
    - Class: ToolbarMixin
      - Kommentar: Mixin providing toolbar functionality for TradingApplication.
      - def create_toolbar(.)
        - Kommentar: Create the application toolbar.
      - def update_data_provider_list(.)
        - Kommentar: Update the list of available market data providers.
  - __init__.py
  - chart_adapter.py
    - Class: ChartAdapter
      - Kommentar: Adapter for converting BacktestResult to Lightweight Charts format.
      - 
      - Provides conversion methods for candlestick data, equity curves, indicators,
      - and trade markers compatible with TradingView Lightweight Charts.
      - def backtest_result_to_chart_data(.)
        - Kommentar: Convert comprehensive BacktestResult to Lightweight Charts JSON format.
        - 
        - Args:
        -     result: BacktestResult instance with bars, trades, equity curve, etc.
        - 
        - Returns:
        -     Dictionary with all chart data ready for Lightweight Charts:
        -     {
        -         'candlesticks': [...],      # OHLC data
        -         'equity_curve': [...],      # Account equity over time
        -         'markers': [...],           # Entry/Exit markers
        -         'indicators': {...},        # Technical indicators
        -         'metadata': {...}           # Chart metadata
        -     }
        - 
        - Example:
        -     >>> adapter = ChartAdapter()
        -     >>> chart_data = adapter.backtest_result_to_chart_data(backtest_result)
        -     >>> json_str = json.dumps(chart_data)
      - def bars_to_candlesticks(.)
        - Kommentar: Convert Bar list to Lightweight Charts candlestick format.
        - 
        - Args:
        -     bars: List of Bar instances
        - 
        - Returns:
        -     List of candlestick dictionaries:
        -     [
        -         {time: '2024-01-01', open: 100, high: 105, low: 99, close: 102},
        -         ...
        -     ]
      - def equity_to_line_series(.)
        - Kommentar: Convert EquityPoint list to Lightweight Charts line series format.
        - 
        - Args:
        -     equity_curve: List of EquityPoint instances
        - 
        - Returns:
        -     List of line series data points:
        -     [
        -         {time: '2024-01-01', value: 10000},
        -         ...
        -     ]
      - def build_markers_from_trades(.)
        - Kommentar: Build entry/exit markers from Trade list.
        - 
        - Args:
        -     trades: List of Trade instances
        -     show_stop_loss: Whether to show stop loss levels as markers
        -     show_take_profit: Whether to show take profit levels as markers
        - 
        - Returns:
        -     List of marker dictionaries for Lightweight Charts:
        -     [
        -         {
        -             time: '2024-01-01',
        -             position: 'belowBar',  # or 'aboveBar'
        -             color: 'green',
        -             shape: 'arrowUp',      # or 'arrowDown', 'circle'
        -             text: 'Buy @ 100.00'
        -         },
        -         ...
        -     ]
      - def _build_entry_marker(.)
        - Kommentar: Build entry marker for a trade.
        - 
        - Args:
        -     trade: Trade instance
        - 
        - Returns:
        -     Entry marker dictionary
      - def _build_exit_marker(.)
        - Kommentar: Build exit marker for a trade.
        - 
        - Args:
        -     trade: Trade instance (must have exit_time and exit_price)
        - 
        - Returns:
        -     Exit marker dictionary
      - def _build_sl_tp_marker(.)
        - Kommentar: Build stop loss or take profit marker.
        - 
        - Args:
        -     trade: Trade instance
        -     marker_type: Type of marker ('stop_loss' or 'take_profit')
        -     price: SL or TP price level
        - 
        - Returns:
        -     SL/TP marker dictionary
      - def indicators_to_series(.)
        - Kommentar: Convert indicator data to Lightweight Charts line series.
        - 
        - Args:
        -     indicators: Dictionary mapping indicator names to time-series data
        -                {name: [(datetime, value), ...]}
        - 
        - Returns:
        -     Dictionary of line series data:
        -     {
        -         'SMA_20': [{time: '2024-01-01', value: 100.5}, ...],
        -         'RSI': [{time: '2024-01-01', value: 65.2}, ...],
        -         ...
        -     }
      - def _format_time(.)
        - Kommentar: Format datetime for Lightweight Charts.
        - 
        - Lightweight Charts accepts:
        - - UNIX timestamp (seconds)
        - - YYYY-MM-DD for daily data
        - - YYYY-MM-DD HH:MM:SS for intraday
        - 
        - Args:
        -     dt: Datetime object
        - 
        - Returns:
        -     Formatted time string
      - def to_json(.)
        - Kommentar: Convert chart data to JSON string.
        - 
        - Args:
        -     chart_data: Chart data dictionary from backtest_result_to_chart_data()
        -     indent: Optional indentation for pretty printing
        - 
        - Returns:
        -     JSON string
        - 
        - Example:
        -     >>> json_str = ChartAdapter.to_json(chart_data, indent=2)
        -     >>> with open('chart.json', 'w') as f:
        -     ...     f.write(json_str)
      - def validate_chart_data(.)
        - Kommentar: Validate chart data structure.
        - 
        - Args:
        -     chart_data: Chart data dictionary
        - 
        - Returns:
        -     Tuple of (is_valid, error_messages)
        - 
        - Example:
        -     >>> is_valid, errors = ChartAdapter.validate_chart_data(chart_data)
        -     >>> if not is_valid:
        -     ...     print("Validation errors:", errors)
  - chart_bridge.py
    - Class: ChartBridge
      - Kommentar: Qt WebChannel bridge for chart communication.
      - 
      - Enables Python ↔ JavaScript communication for chart updates:
      - - Python → JS: Emit signals with chart data (JSON)
      - - JS → Python: Call slots to request data or perform actions
      - 
      - Signals:
      -     chartDataReady: Emitted when chart data is ready (JSON string)
      -     error: Emitted when an error occurs (error message)
      -     statusChanged: Emitted when bridge status changes (status message)
      - 
      - Example Usage:
      -     # In Python (PyQt6):
      -     bridge = ChartBridge()
      -     channel = QWebChannel()
      -     channel.registerObject("chartBridge", bridge)
      -     web_view.page().setWebChannel(channel)
      - 
      -     # Load backtest result
      -     bridge.loadBacktestResult(result.model_dump_json())
      - 
      -     # In JavaScript:
      -     new QWebChannel(qt.webChannelTransport, function(channel) {
      -         var chartBridge = channel.objects.chartBridge;
      - 
      -         chartBridge.chartDataReady.connect(function(jsonData) {
      -             var data = JSON.parse(jsonData);
      -             renderChart(data);
      -         });
      -     });
      - def __init__(.)
        - Kommentar: Initialize ChartBridge.
        - 
        - Args:
        -     parent: Optional parent QObject
      - def loadBacktestResult(.)
        - Kommentar: Load and display backtest result from JSON.
        - 
        - Called from JavaScript to load backtest data.
        - 
        - Args:
        -     result_json: BacktestResult as JSON string
        - 
        - Emits:
        -     chartDataReady: When conversion is successful
        -     error: When conversion fails
      - def loadBacktestResultObject(.)
        - Kommentar: Load and display backtest result from Python object.
        - 
        - Called from Python code to display backtest.
        - 
        - Args:
        -     result: BacktestResult instance
        - 
        - Emits:
        -     chartDataReady: When conversion is successful
        -     error: When conversion fails
      - def loadLiveData(.)
        - Kommentar: Load and display live market data for a symbol.
        - 
        - Called from JavaScript to request live data.
        - 
        - Args:
        -     symbol: Trading symbol (e.g., "AAPL")
        - 
        - Emits:
        -     chartDataReady: When data is loaded
        -     error: When loading fails
        - 
        - Note:
        -     This is a placeholder. In a real implementation, this would:
        -     1. Fetch live bars from market data provider
        -     2. Convert to chart format
        -     3. Emit chartDataReady signal
      - def updateTrade(.)
        - Kommentar: Update chart with new trade marker (for live trading).
        - 
        - Called from JavaScript or Python when a trade is executed.
        - 
        - Args:
        -     trade_json: Trade as JSON string
        - 
        - Emits:
        -     chartDataReady: With updated markers
        -     error: When update fails
        - 
        - Note:
        -     This updates only the markers, not the full chart.
      - def getCurrentSymbol(.)
        - Kommentar: Get currently displayed symbol.
        - 
        - Returns:
        -     Symbol string or empty string if none loaded
      - def getMetricsSummary(.)
        - Kommentar: Get summary of current backtest metrics as JSON.
        - 
        - Returns:
        -     JSON string with key metrics or empty object
      - def clearChart(.)
        - Kommentar: Clear the current chart.
        - 
        - Emits:
        -     chartDataReady: With empty data
        -     statusChanged: With clear message
      - def toggleMarkers(.)
        - Kommentar: Toggle trade markers on/off.
        - 
        - Args:
        -     show: True to show markers, False to hide
        - 
        - Emits:
        -     chartDataReady: With updated data
      - def toggleIndicator(.)
        - Kommentar: Toggle specific indicator on/off.
        - 
        - Args:
        -     indicator_name: Name of indicator (e.g., "SMA_20")
        -     show: True to show, False to hide
        - 
        - Emits:
        -     chartDataReady: With updated indicators
      - def _convert_and_emit_chart_data(.)
        - Kommentar: Convert BacktestResult to chart data and emit signal.
        - 
        - Args:
        -     result: BacktestResult to convert
        - 
        - Emits:
        -     chartDataReady: With converted chart data
        -     statusChanged: With status message
        -     error: If conversion fails
  - chart_window_manager.py
    - Class: ChartWindowManager
      - Kommentar: Manages popup chart windows.
      - def __init__(.)
        - Kommentar: Initialize chart window manager.
        - 
        - Args:
        -     history_manager: HistoryManager instance for loading data
        -     parent: Parent widget for the windows
      - def open_or_focus_chart(.)
        - Kommentar: Open a chart window for the symbol, or focus if already open.
        - 
        - Args:
        -     symbol: Trading symbol
        -     data_provider: Optional data provider to use
        - 
        - Returns:
        -     ChartWindow instance
      - def _on_window_closed(.)
        - Kommentar: Handle window closed signal.
        - 
        - Args:
        -     symbol: Symbol of the closed window
      - def close_window(.)
        - Kommentar: Close a chart window.
        - 
        - Args:
        -     symbol: Symbol of the window to close
      - def close_all_windows(.)
        - Kommentar: Close all open chart windows.
      - def get_open_symbols(.)
        - Kommentar: Get list of symbols with open chart windows.
        - 
        - Returns:
        -     List of symbol strings
      - def has_open_window(.)
        - Kommentar: Check if a window is open for the symbol.
        - 
        - Args:
        -     symbol: Trading symbol
        - 
        - Returns:
        -     True if window is open, False otherwise
      - def get_active_symbol(.)
        - Kommentar: Get the symbol of the currently focused/active chart window.
        - 
        - Returns:
        -     Symbol string if an active chart exists, None otherwise
      - def open_chart(.)
        - Kommentar: Open a chart window (alias for open_or_focus_chart).
        - 
        - This method provides compatibility with code that used EnhancedChartWindow.
        - 
        - Args:
        -     symbol: Trading symbol
        -     chart_type: Chart type (ignored, uses TradingView)
        - 
        - Returns:
        -     ChartWindow instance
      - def close_all_charts(.)
        - Kommentar: Close all open chart windows (alias for close_all_windows).
    - def get_chart_window_manager(.)
      - Kommentar: Get or create the singleton ChartWindowManager instance.
      - 
      - This function provides a global access point to the ChartWindowManager,
      - migrated from enhanced_chart_window.py.
      - 
      - Args:
      -     history_manager: HistoryManager instance (only used on first call)
      -     parent: Parent widget (only used on first call)
      - 
      - Returns:
      -     ChartWindowManager singleton instance
    - Kommentar: Singleton instance
  - __init__.py
  - ai_backtest_dialog.py
    - Class: AIBacktestDialog
      - Kommentar: Enhanced backtest dialog with AI analysis.
      - def __init__(.)
        - Kommentar: Initialize AI Backtest Dialog.
        - 
        - Args:
        -     parent: Parent widget
        -     current_symbol: Currently selected symbol from chart (optional)
      - def init_ui(.)
        - Kommentar: Initialize the UI.
      - def _create_config_tab(.)
        - Kommentar: Create configuration tab.
      - def _create_results_tab(.)
        - Kommentar: Create results tab.
      - def _create_ai_tab(.)
        - Kommentar: Create AI analysis tab.
      - def _create_chart_tab(.)
        - Kommentar: Create chart visualization tab with BacktestChartWidget.
      - def run_backtest(.)
        - Kommentar: Run the backtest.
      - def _create_mock_result(.)
        - Kommentar: Create mock backtest result.
      - def _display_results(.)
        - Kommentar: Display backtest results.
      - def run_ai_review(.)
        - Kommentar: Run AI analysis on backtest results.
      - def _display_ai_analysis(.)
        - Kommentar: Display AI analysis results.
      - def _add_section(.)
        - Kommentar: Add a section with title and content.
      - def _add_list_section(.)
        - Kommentar: Add a section with a bullet-point list.
      - def _add_dict_section(.)
        - Kommentar: Add a section displaying dictionary data.
      - def _create_improvement_widget(.)
        - Kommentar: Create widget for improvement suggestion.
      - def _open_chart_popup(.)
        - Kommentar: Open chart popup window with backtest results.
        - 
        - Args:
        -     result: BacktestResult to display
      - def _show_no_api_key_message(.)
        - Kommentar: Show message when no API key is configured.
  - backtest_dialog.py
    - Class: BacktestDialog
      - Kommentar: Dialog for running backtests.
      - def __init__(.)
      - def init_ui(.)
        - Kommentar: Initialize the backtest dialog UI.
      - def run_backtest(.)
        - Kommentar: Run the backtest.
      - def _run_backtest_simulation(.)
        - Kommentar: Simulate backtest execution.
      - def export_results(.)
        - Kommentar: Export backtest results.
  - order_dialog.py
    - Class: OrderDialog
      - Kommentar: Dialog for placing orders with AI analysis.
      - def __init__(.)
      - def init_ui(.)
        - Kommentar: Initialize the order dialog UI.
      - def on_order_type_changed(.)
        - Kommentar: Handle order type changes.
      - def analyze_order(.)
        - Kommentar: Analyze order with AI.
      - def _get_ai_analysis(.)
        - Kommentar: Get AI analysis for the order.
      - def place_order(.)
        - Kommentar: Place the order via broker.
  - parameter_optimization_dialog.py
    - Class: ParameterOptimizationDialog
      - Kommentar: Dialog for AI-guided parameter optimization.
      - def __init__(.)
        - Kommentar: Initialize Parameter Optimization Dialog.
        - 
        - Args:
        -     parent: Parent widget
        -     current_symbol: Currently selected symbol from chart (optional)
      - def init_ui(.)
        - Kommentar: Initialize UI.
      - def _create_config_tab(.)
        - Kommentar: Create configuration tab.
      - def _update_combination_count(.)
        - Kommentar: Update total combination count label.
      - def _create_progress_tab(.)
        - Kommentar: Create progress monitoring tab.
      - def _create_results_tab(.)
        - Kommentar: Create results display tab.
      - def _create_ai_tab(.)
        - Kommentar: Create AI insights tab.
      - def _create_chart_tab(.)
        - Kommentar: Create chart visualization tab for best result.
      - def start_optimization(.)
        - Kommentar: Start parameter optimization.
      - def _run_real_backtest(.)
        - Kommentar: Run REAL backtest with actual market data (NO MOCK!).
        - 
        - Args:
        -     params: Strategy parameters to test
        - 
        - Returns:
        -     BacktestResult with real metrics from backtrader
      - def _display_results(.)
        - Kommentar: Display optimization results.
      - def _open_chart_popup(.)
        - Kommentar: Open chart popup window with backtest results.
        - 
        - Args:
        -     result: BacktestResult to display
      - def _display_ai_insights(.)
        - Kommentar: Display AI insights.
      - def log_progress(.)
        - Kommentar: Log progress message.
      - def stop_optimization(.)
        - Kommentar: Stop optimization.
  - settings_dialog.py
    - Class: SettingsDialog
      - Kommentar: Application settings dialog.
      - def __init__(.)
      - def init_ui(.)
        - Kommentar: Initialize the settings dialog UI.
      - def load_current_settings(.)
        - Kommentar: Load current settings from QSettings.
      - def save_settings(.)
        - Kommentar: Save settings to QSettings and configuration.
  - icons.py
    - Class: IconProvider
      - Kommentar: Provides themed icons for the application.
      - def __init__(.)
        - Kommentar: Initialize icon provider.
        - 
        - Args:
        -     theme: Theme name ("dark" or "light")
      - def _update_colors(.)
        - Kommentar: Update colors based on theme.
      - def set_theme(.)
        - Kommentar: Change theme and clear cache.
        - 
        - Args:
        -     theme: Theme name ("dark" or "light")
      - def get_icon(.)
        - Kommentar: Get icon by name.
        - 
        - Args:
        -     name: Icon name
        - 
        - Returns:
        -     QIcon instance
      - def get_available_icons(.)
        - Kommentar: Get list of available icon names.
        - 
        - Returns:
        -     List of icon names
    - def _svg_to_icon(.)
      - Kommentar: Convert SVG string to QIcon with color substitution.
      - 
      - Args:
      -     svg_data: SVG XML string with {{primary}} and {{secondary}} placeholders
      -     primary_color: Primary color (default: white)
      -     secondary_color: Secondary color (default: blue)
      - 
      - Returns:
      -     QIcon with rendered SVG
    - def get_icon(.)
      - Kommentar: Get icon by name using global provider.
      - 
      - Args:
      -     name: Icon name
      - 
      - Returns:
      -     QIcon instance
    - def set_icon_theme(.)
      - Kommentar: Set global icon theme.
      - 
      - Args:
      -     theme: Theme name ("dark" or "light")
    - def get_available_icons(.)
      - Kommentar: Get list of available icon names.
      - 
      - Returns:
      -     List of icon names
    - Kommentar: SVG icon templates
    - Kommentar: Global icon provider instance
  - themes.py
    - Class: ThemeManager
      - Kommentar: Manages application themes.
      - def __init__(.)
        - Kommentar: Initialize theme manager.
      - def _create_dark_theme(.)
        - Kommentar: Create dark theme stylesheet.
      - def _create_light_theme(.)
        - Kommentar: Create light theme stylesheet.
      - def get_dark_theme(.)
        - Kommentar: Get dark theme stylesheet.
      - def get_light_theme(.)
        - Kommentar: Get light theme stylesheet.
      - def get_theme(.)
        - Kommentar: Get theme by name.
  - __init__.py
  - alerts.py
    - Class: AlertsWidget
      - Kommentar: Widget for displaying trading alerts.
      - def __init__(.)
      - def init_ui(.)
        - Kommentar: Initialize the alerts UI.
      - def setup_event_handlers(.)
        - Kommentar: Setup event bus handlers.
      - def on_alert_triggered(.)
        - Kommentar: Handle alert triggered event.
      - def on_order_rejected(.)
        - Kommentar: Handle order rejected event.
      - def on_app_error(.)
        - Kommentar: Handle application error event.
      - def add_alert(.)
        - Kommentar: Add a new alert to the list.
  - backtest_chart_widget.py
    - Class: BacktestChartWidget
      - Kommentar: Chart widget for displaying backtest results.
      - 
      - Uses Qt WebChannel to communicate between Python and JavaScript,
      - displaying interactive charts with TradingView Lightweight Charts.
      - 
      - Features:
      -     - Display backtest candlesticks
      -     - Show equity curve
      -     - Trade markers (entry/exit with P&L)
      -     - Technical indicators
      -     - Toggle markers and indicators
      -     - Responsive and interactive
      - 
      - Example:
      -     widget = BacktestChartWidget()
      -     widget.load_backtest_result(backtest_result)
      - def __init__(.)
        - Kommentar: Initialize backtest chart widget.
        - 
        - Args:
        -     parent: Optional parent widget
      - def _setup_ui(.)
        - Kommentar: Setup user interface.
      - def _create_toolbar(.)
        - Kommentar: Create toolbar with controls.
        - 
        - Returns:
        -     QToolBar instance
      - def _setup_webchannel(.)
        - Kommentar: Setup Qt WebChannel for Python ↔ JavaScript communication.
      - def _setup_connections(.)
        - Kommentar: Setup signal/slot connections.
      - def _load_html(.)
        - Kommentar: Load HTML template with Lightweight Charts.
      - def load_backtest_result(.)
        - Kommentar: Load and display backtest result.
        - 
        - Args:
        -     result: BacktestResult instance to display
      - def clear_chart(.)
        - Kommentar: Clear the current chart.
      - def toggle_markers(.)
        - Kommentar: Toggle trade markers visibility.
        - 
        - Args:
        -     show: True to show markers, False to hide
      - def _on_toggle_markers(.)
        - Kommentar: Handle toggle markers button click.
      - def _on_clear_chart(.)
        - Kommentar: Handle clear chart button click.
      - def _on_chart_data_ready(.)
        - Kommentar: Handle chart data ready signal from bridge.
        - 
        - Args:
        -     json_data: Chart data as JSON string
      - def _on_bridge_error(.)
        - Kommentar: Handle error from bridge.
        - 
        - Args:
        -     error_msg: Error message
      - def _on_status_changed(.)
        - Kommentar: Handle status change from bridge.
        - 
        - Args:
        -     status_msg: Status message
      - def closeEvent(.)
        - Kommentar: Handle widget close event.
        - 
        - Args:
        -     event: Close event
  - __init__.py
  - data_loading_mixin.py
    - Class: DataLoadingMixin
      - Kommentar: Mixin providing data loading functionality for EmbeddedTradingViewChart.
      - def load_data(.)
        - Kommentar: Load market data into chart.
        - 
        - Args:
        -     data: OHLCV DataFrame with DatetimeIndex
      - def load_symbol(.)
        - Kommentar: Load symbol data and display chart.
        - 
        - Args:
        -     symbol: Trading symbol
        -     data_provider: Data provider (alpaca, yahoo, etc.)
      - def refresh_data(.)
        - Kommentar: Public method to refresh chart data (called by main app).
      - def _on_symbol_change(.)
        - Kommentar: Handle symbol change.
      - def _on_timeframe_change(.)
        - Kommentar: Handle timeframe (candle size) change.
      - def _on_period_change(.)
        - Kommentar: Handle time period change.
      - def _on_load_chart(.)
        - Kommentar: Load chart data for current symbol.
      - def _load_chart_async(.)
        - Kommentar: Async implementation of chart loading.
      - def _on_refresh(.)
        - Kommentar: Refresh current chart.
    - def get_local_timezone_offset_seconds(.)
      - Kommentar: Get local timezone offset in seconds (positive for east of UTC).
      - 
      - This accounts for DST automatically.
  - indicator_mixin.py
    - Class: IndicatorMixin
      - Kommentar: Mixin providing indicator functionality for EmbeddedTradingViewChart.
      - def _get_indicator_configs(.)
        - Kommentar: Get indicator configuration dictionaries.
        - 
        - Returns:
        -     Tuple of (overlay_configs, oscillator_configs)
      - def _convert_macd_data_to_chart_format(.)
        - Kommentar: Convert MACD indicator result to chart format.
        - 
        - Args:
        -     result: IndicatorResult with DataFrame values
        - 
        - Returns:
        -     Dict with 'macd', 'signal', 'histogram' keys
      - def _convert_multi_series_data_to_chart_format(.)
        - Kommentar: Convert multi-series indicator result to chart format.
        - 
        - Args:
        -     result: IndicatorResult with DataFrame values
        -     ind_id: Indicator ID string
        - 
        - Returns:
        -     List of time/value dicts
      - def _convert_single_series_data_to_chart_format(.)
        - Kommentar: Convert single-series indicator result to chart format.
        - 
        - Args:
        -     result: IndicatorResult with Series values
        - 
        - Returns:
        -     List of time/value dicts
      - def _create_overlay_indicator(.)
        - Kommentar: Create overlay indicator on price chart.
        - 
        - Args:
        -     display_name: Display name for the indicator
        -     color: Color string for the indicator
      - def _create_oscillator_panel(.)
        - Kommentar: Create oscillator panel with indicator-specific reference lines.
        - 
        - Args:
        -     ind_id: Indicator ID string
        -     display_name: Display name for the panel
        -     color: Color string for the indicator
        -     min_val: Minimum value for y-axis (or None)
        -     max_val: Maximum value for y-axis (or None)
      - def _add_oscillator_reference_lines(.)
        - Kommentar: Add indicator-specific reference lines to oscillator panel.
        - 
        - Args:
        -     ind_id: Indicator ID string
        -     panel_id: Panel ID string
      - def _update_overlay_data(.)
        - Kommentar: Update overlay indicator data on price chart.
        - 
        - Args:
        -     display_name: Display name of the indicator
        -     ind_data: List of time/value dicts
      - def _update_oscillator_data(.)
        - Kommentar: Update oscillator panel data.
        - 
        - Args:
        -     ind_id: Indicator ID string
        -     ind_data: Either list of time/value dicts or dict with multiple series
      - def _remove_indicator_from_chart(.)
        - Kommentar: Remove indicator from chart.
        - 
        - Args:
        -     ind_id: Indicator ID string
        -     display_name: Display name of the indicator
        -     is_overlay: True if overlay indicator, False if oscillator
      - def _update_indicators(.)
        - Kommentar: Update technical indicators on chart.
      - def _update_indicators_realtime(.)
        - Kommentar: Update indicators in real-time with new candle data.
        - 
        - Args:
        -     candle: New candle dict with time, open, high, low, close
      - def _update_indicators_button_badge(.)
        - Kommentar: Update indicators button to show count of active indicators.
      - def _on_indicator_toggled(.)
        - Kommentar: Handle indicator toggle from dropdown menu.
        - 
        - Args:
        -     action: The QAction that was toggled
    - def _ts_to_local_unix(.)
      - Kommentar: Convert timestamp to Unix seconds with local timezone offset for chart display.
  - state_mixin.py
    - Class: ChartStateMixin
      - Kommentar: Mixin providing state management for EmbeddedTradingViewChart.
      - def get_visible_range(.)
        - Kommentar: Asynchronously get the current visible logical range.
        - 
        - Args:
        -     callback: Function to call with the result (dict/None)
      - def set_visible_range(.)
        - Kommentar: Restore visible logical range.
        - 
        - Args:
        -     range_data: Dictionary with 'from' and 'to' logical indices
      - def get_pane_layout(.)
        - Kommentar: Asynchronously get the current pane layout (stretch factors).
        - 
        - Args:
        -     callback: Function to call with the result (dict)
      - def set_pane_layout(.)
        - Kommentar: Restore pane layout (stretch factors).
        - 
        - Args:
        -     layout: Dictionary mapping pane IDs to stretch factors
      - def get_chart_state(.)
        - Kommentar: Get comprehensive chart state including panes, zoom, and indicators.
        - 
        - Args:
        -     callback: Function to call with the complete state dict
      - def set_chart_state(.)
        - Kommentar: Restore comprehensive chart state.
        - 
        - Args:
        -     state: State dictionary from get_chart_state()
  - streaming_mixin.py
    - Class: StreamingMixin
      - Kommentar: Mixin providing streaming functionality for EmbeddedTradingViewChart.
      - def _on_market_bar(.)
        - Kommentar: Handle market bar event.
      - def _on_market_tick(.)
        - Kommentar: Handle market tick event - update current candle in real-time.
      - def _process_pending_updates(.)
        - Kommentar: Process pending bar updates (batched for performance).
      - def _toggle_live_stream(.)
        - Kommentar: Toggle live streaming on/off.
      - def _start_live_stream_async(.)
        - Kommentar: Async wrapper for starting live stream.
      - def _stop_live_stream_async(.)
        - Kommentar: Async wrapper for stopping live stream.
      - def _start_live_stream(.)
        - Kommentar: Start live streaming for current symbol.
      - def _stop_live_stream(.)
        - Kommentar: Stop live streaming - disconnect WebSocket to free connection slot.
  - toolbar_mixin.py
    - Class: ToolbarMixin
      - Kommentar: Mixin providing toolbar functionality for EmbeddedTradingViewChart.
      - def _create_toolbar(.)
        - Kommentar: Create chart toolbar.
  - chart_window.py
    - Class: ChartWindow
      - Kommentar: Popup window for displaying a single chart.
      - def __init__(.)
        - Kommentar: Initialize chart window.
        - 
        - Args:
        -     symbol: Trading symbol to display
        -     history_manager: HistoryManager instance for loading data
        -     parent: Parent widget
      - def _activate_live_stream(.)
        - Kommentar: Activate live streaming when chart data is loaded.
      - def closeEvent(.)
        - Kommentar: Handle window close event with async state saving.
      - def load_chart(.)
        - Kommentar: Load chart data for the symbol.
        - 
        - Args:
        -     data_provider: Optional data provider to use
  - __init__.py
  - backtest_mixin.py
    - Class: BacktestMixin
      - Kommentar: Mixin providing backtest functionality for ChartWindow.
      - def _apply_strategy(.)
        - Kommentar: Apply selected strategy to chart - simple visualization without backtrader.
      - def _generate_macd_signals(.)
        - Kommentar: Generate buy/sell signals from MACD crossover.
      - def _generate_rsi_signals(.)
        - Kommentar: Generate buy/sell signals from RSI overbought/oversold.
      - def _generate_bollinger_signals(.)
        - Kommentar: Generate buy/sell signals from Bollinger Bands.
      - def _generate_ma_signals(.)
        - Kommentar: Generate buy/sell signals from Moving Average crossover.
      - def _simulate_trades(.)
        - Kommentar: Simulate trades with stop loss and take profit.
      - def _draw_strategy_markers(.)
        - Kommentar: Draw entry, exit, SL, and TP markers on chart.
      - def _clear_strategy_markers(.)
        - Kommentar: Clear all strategy markers from chart.
      - def _run_ai_strategy_analysis(.)
        - Kommentar: Run AI analysis on strategy trades asynchronously.
      - def _display_ai_analysis(.)
        - Kommentar: Display AI analysis results in the Results tab.
      - def _calculate_trade_stats(.)
        - Kommentar: Calculate win/loss statistics.
      - def _display_strategy_results(.)
        - Kommentar: Display strategy results in Results tab.
      - def _run_backtest(.)
        - Kommentar: Run backtest with chart data.
        - 
        - Note: For simple strategy visualization, use 'Apply Strategy to Chart' instead.
        - This backtest uses the full Backtrader engine for more detailed analysis.
      - def _create_strategy_config_from_ui(.)
        - Kommentar: Create StrategyConfig from current UI parameters.
      - def _display_backtest_results(.)
        - Kommentar: Display backtest results in Results tab.
      - def _add_trade_markers_to_chart(.)
        - Kommentar: Add Entry/Exit markers to chart.
      - def _start_optimization(.)
        - Kommentar: Start parameter optimization.
  - event_bus_mixin.py
    - Class: EventBusMixin
      - Kommentar: Mixin providing event bus integration for ChartWindow.
      - def _setup_event_subscriptions(.)
        - Kommentar: Subscribe to event bus for live trade marker updates.
      - def _on_trade_entry(.)
        - Kommentar: Handle TRADE_ENTRY event - add entry marker to chart.
      - def _on_trade_exit(.)
        - Kommentar: Handle TRADE_EXIT event - add exit marker to chart.
      - def _on_stop_loss_hit(.)
        - Kommentar: Handle STOP_LOSS_HIT event - add SL marker to chart.
      - def _on_take_profit_hit(.)
        - Kommentar: Handle TAKE_PROFIT_HIT event - add TP marker to chart.
      - def _on_order_filled(.)
        - Kommentar: Handle ORDER_FILLED event - add fill marker to chart.
      - def _on_market_bar(.)
        - Kommentar: Handle MARKET_BAR event - update chart with real-time data.
      - def _update_chart_bar(.)
        - Kommentar: Update the chart with a new real-time bar.
      - def _add_single_marker(.)
        - Kommentar: Add a single marker to the chart in real-time.
      - def _unsubscribe_events(.)
        - Kommentar: Unsubscribe from all event bus events.
  - panels_mixin.py
    - Class: PanelsMixin
      - Kommentar: Mixin providing panel/tab creation for ChartWindow.
      - def _create_bottom_panel(.)
        - Kommentar: Create bottom panel with tabs.
      - def _toggle_bottom_panel(.)
        - Kommentar: Toggle visibility of bottom panel dock widget.
      - def _on_dock_visibility_changed(.)
        - Kommentar: Handle dock visibility changes.
      - def _update_toggle_button_text(.)
        - Kommentar: Update the toggle button text based on state.
      - def _create_strategy_tab(.)
        - Kommentar: Create strategy configuration tab.
      - def _create_backtest_tab(.)
        - Kommentar: Create backtest controls tab.
      - def _create_optimization_tab(.)
        - Kommentar: Create parameter optimization tab.
      - def _create_results_tab(.)
        - Kommentar: Create results display tab.
      - def _on_strategy_selected(.)
        - Kommentar: Handle strategy selection change.
  - state_mixin.py
    - Class: StateMixin
      - Kommentar: Mixin providing state save/restore for ChartWindow.
      - def _load_window_state(.)
        - Kommentar: Load window position and size from settings.
      - def _get_settings_key(.)
        - Kommentar: Get sanitized settings key for this symbol.
      - def _save_window_state(.)
        - Kommentar: Save window position, size, and chart settings.
      - def _restore_chart_state(.)
        - Kommentar: Restore pane sizes and zoom level from settings.
        - 
        - IMPORTANT: This is called when data_loaded signal is emitted.
        - We use a short delay (100ms) to let the chart render the data first,
        - then immediately restore the saved state.
      - def _finalize_restoration(.)
        - Kommentar: Clean up after state restoration.
      - def _restore_indicators_after_data_load(.)
        - Kommentar: Restore indicators after data has been loaded.
        - 
        - NOTE: Visible range is restored by _restore_chart_state(), not here.
        - This function only handles indicators to avoid duplicate restoration.
      - def _restore_zoom_state_now(.)
        - Kommentar: Restore zoom/visible range state immediately (no delay).
      - def _restore_pane_layout_now(.)
        - Kommentar: Restore pane layout/row heights with minimal delay.
      - def _restore_indicators_now(.)
        - Kommentar: Restore indicators.
      - def _sanitize_symbol(.)
        - Kommentar: Sanitize symbol for use in settings keys.
      - def load_backtest_result(.)
        - Kommentar: Load and display backtest result in chart window.
  - dashboard.py
    - Class: DashboardWidget
      - Kommentar: Main dashboard widget displaying account overview.
      - def __init__(.)
      - def init_ui(.)
        - Kommentar: Initialize the dashboard UI.
      - def _create_stat_widget(.)
        - Kommentar: Create a statistics display widget.
      - def setup_event_handlers(.)
        - Kommentar: Setup event bus handlers.
      - def on_order_filled(.)
        - Kommentar: Handle order filled event.
      - def on_market_connected(.)
        - Kommentar: Handle market connected event.
      - def update_balance(.)
        - Kommentar: Update balance display.
        - 
        - Args:
        -     balance: Balance object or tuple of (equity, cash)
      - def update_pnl(.)
        - Kommentar: Update P&L display.
      - def update_positions_count(.)
        - Kommentar: Update open positions count.
      - def refresh_stats(.)
        - Kommentar: Refresh dashboard statistics from database or broker.
  - embedded_tradingview_chart.py
    - Class: EmbeddedTradingViewChart
      - Kommentar: Embedded TradingView Lightweight Charts widget.
      - 
      - Features:
      - - Fully embedded in Qt application (no external windows)
      - - Chromium-based WebEngine rendering
      - - Professional TradingView appearance
      - - Real-time updates
      - - Technical indicators support
      - def __init__(.)
        - Kommentar: Initialize embedded chart widget.
        - 
        - Args:
        -     history_manager: HistoryManager instance for loading data
      - def _on_market_tick_event(.)
        - Kommentar: Event bus callback - emit signal for thread-safe handling.
      - def _on_market_bar_event(.)
        - Kommentar: Event bus callback - emit signal for thread-safe handling.
      - def _handle_tick_main_thread(.)
        - Kommentar: Handle tick in main thread (thread-safe).
      - def _handle_bar_main_thread(.)
        - Kommentar: Handle bar in main thread (thread-safe).
      - def _show_error_ui(.)
        - Kommentar: Show error message if WebEngine not available.
      - def _setup_ui(.)
        - Kommentar: Setup the UI components.
      - def _execute_js(.)
        - Kommentar: Execute JavaScript in the web view, queueing until chart is ready.
      - def _flush_pending_js(.)
        - Kommentar: Run any JS commands that were queued before chart initialization completed.
      - def _on_page_loaded(.)
        - Kommentar: Handle page load completion.
      - def _start_chart_ready_poll(.)
        - Kommentar: Poll inside the WebEngine until window.chartAPI exists.
      - def _poll_chart_ready(.)
      - def _on_chart_ready_result(.)
    - Kommentar: HTML template for TradingView Lightweight Charts
  - indicators.py
    - Class: IndicatorsWidget
      - Kommentar: Widget for managing technical indicators.
      - def __init__(.)
        - Kommentar: Initialize indicators widget.
      - def _setup_ui(.)
        - Kommentar: Setup the UI components.
      - def _add_indicator(.)
        - Kommentar: Add a new indicator.
      - def _remove_indicator(.)
        - Kommentar: Remove selected indicator.
  - orders.py
    - Class: OrdersWidget
      - Kommentar: Widget for displaying orders.
      - def __init__(.)
      - def _get_table_columns(.)
        - Kommentar: Define order table columns.
      - def _get_column_keys(.)
        - Kommentar: Define keys for mapping order data to columns.
      - def _setup_event_subscriptions(.)
        - Kommentar: Setup event bus handlers.
      - def on_order_created(.)
        - Kommentar: Handle order created event.
      - def on_order_updated(.)
        - Kommentar: Handle order update events.
      - def add_order(.)
        - Kommentar: Add a new order to the table.
      - def update_order(.)
        - Kommentar: Update an existing order in the table.
  - performance_dashboard.py
    - Class: PerformanceMetrics
      - Kommentar: Performance metrics data.
    - Class: MetricCard
      - Kommentar: Widget for displaying a single metric.
      - def __init__(.)
        - Kommentar: Initialize metric card.
        - 
        - Args:
        -     title: Metric title
        -     value: Metric value
        -     suffix: Value suffix (%, $, etc.)
        -     color: Text color
      - def update_value(.)
        - Kommentar: Update the metric value.
        - 
        - Args:
        -     value: New value
        -     suffix: Value suffix
    - Class: PerformanceDashboard
      - Kommentar: Performance dashboard widget.
      - def __init__(.)
        - Kommentar: Initialize performance dashboard.
      - def _setup_ui(.)
        - Kommentar: Setup the UI components.
      - def _create_overview_tab(.)
        - Kommentar: Create overview tab.
      - def _create_returns_tab(.)
        - Kommentar: Create returns analysis tab.
      - def _create_trades_tab(.)
        - Kommentar: Create trades analysis tab.
      - def _create_positions_tab(.)
        - Kommentar: Create positions tab.
      - def _create_ai_tab(.)
        - Kommentar: Create AI analytics tab.
      - def _create_reports_tab(.)
        - Kommentar: Create reports tab.
      - def _setup_timers(.)
        - Kommentar: Setup update timers.
      - def _load_performance_data(.)
        - Kommentar: Load performance data from database.
      - def _get_date_range(.)
        - Kommentar: Get date range based on selected period.
        - 
        - Returns:
        -     Tuple of (start_date, end_date)
      - def _calculate_metrics(.)
        - Kommentar: Calculate performance metrics.
        - 
        - Args:
        -     orders: List of orders
        -     positions: List of positions
        -     ai_data: List of AI telemetry records
      - def _update_ui(.)
        - Kommentar: Update UI with current metrics.
      - def _update_metrics(.)
        - Kommentar: Update metrics (called by timer).
      - def _on_period_changed(.)
        - Kommentar: Handle period change.
        - 
        - Args:
        -     period: Selected period
      - def _apply_custom_dates(.)
        - Kommentar: Apply custom date range.
      - def _generate_report(.)
        - Kommentar: Generate performance report.
      - def _create_report_content(.)
        - Kommentar: Create report content.
        - 
        - Args:
        -     report_type: Type of report
        - 
        - Returns:
        -     Report content as text
      - def _on_order_filled(.)
        - Kommentar: Handle order filled event.
        - 
        - Args:
        -     event: Order filled event
      - def _on_position_closed(.)
        - Kommentar: Handle position closed event.
        - 
        - Args:
        -     event: Position closed event
  - positions.py
    - Class: PositionsWidget
      - Kommentar: Widget for displaying current positions.
      - def _get_table_columns(.)
        - Kommentar: Define position table columns.
      - def _get_column_keys(.)
        - Kommentar: Define keys for mapping position data to columns.
      - def _get_format_functions(.)
        - Kommentar: Define format functions for columns.
      - def update_positions(.)
        - Kommentar: Update positions table.
      - def _setup_event_subscriptions(.)
        - Kommentar: Setup event bus handlers.
      - def on_order_filled(.)
        - Kommentar: Handle order filled event - refresh positions.
      - def on_market_tick(.)
        - Kommentar: Handle market tick - update prices if needed.
      - def refresh(.)
        - Kommentar: Refresh positions display from database.
  - watchlist.py
    - Class: WatchlistWidget
      - Kommentar: Widget displaying watchlist with real-time updates.
      - def __init__(.)
        - Kommentar: Initialize watchlist widget.
        - 
        - Args:
        -     parent: Parent widget
      - def init_ui(.)
        - Kommentar: Initialize user interface.
      - def setup_event_handlers(.)
        - Kommentar: Setup event bus handlers.
      - def on_market_tick(.)
        - Kommentar: Handle market tick events.
        - 
        - Args:
        -     event: Market tick event
      - def on_market_bar(.)
        - Kommentar: Handle market bar events.
        - 
        - Args:
        -     event: Market bar event
      - def update_prices(.)
        - Kommentar: Update prices in the table.
      - def format_volume(.)
        - Kommentar: Format volume for display.
        - 
        - Args:
        -     volume: Volume value
        - 
        - Returns:
        -     Formatted string
      - def add_symbol_from_input(.)
        - Kommentar: Add symbol from input field.
      - def add_symbol(.)
        - Kommentar: Add symbol to watchlist.
        - 
        - Args:
        -     symbol_data: Trading symbol (string) or dict with {symbol, name, wkn}
        -     save: Whether to save watchlist immediately (default: True, set False for batch operations)
      - def remove_symbol(.)
        - Kommentar: Remove symbol from watchlist.
        - 
        - Args:
        -     symbol: Trading symbol
      - def clear_watchlist(.)
        - Kommentar: Clear all symbols from watchlist.
      - def add_indices(.)
        - Kommentar: Add major market indices.
      - def add_tech_stocks(.)
        - Kommentar: Add major tech stocks.
      - def add_crypto_pairs(.)
        - Kommentar: Add major cryptocurrency trading pairs.
      - def on_symbol_double_clicked(.)
        - Kommentar: Handle symbol double-click.
        - 
        - Args:
        -     item: Clicked table item
      - def show_context_menu(.)
        - Kommentar: Show context menu for table.
        - 
        - Args:
        -     position: Menu position
      - def create_order(.)
        - Kommentar: Create order for symbol.
        - 
        - Args:
        -     symbol: Trading symbol
      - def load_default_watchlist(.)
        - Kommentar: Load default watchlist on startup.
      - def save_watchlist(.)
        - Kommentar: Save watchlist to settings.
      - def get_symbols(.)
        - Kommentar: Get list of watched symbols.
        - 
        - Returns:
        -     List of symbols
      - def save_column_state(.)
        - Kommentar: Save column widths and order to settings.
      - def load_column_state(.)
        - Kommentar: Load column widths and order from settings.
      - def closeEvent(.)
        - Kommentar: Handle widget close event - save column state.
        - 
        - Args:
        -     event: Close event
  - widget_helpers.py
    - Class: EventBusWidget
      - Kommentar: Base widget with event bus integration.
      - 
      - Provides automatic event subscription/unsubscription lifecycle management.
      - Subclasses should implement _setup_event_subscriptions() to register handlers.
      - def __init__(.)
        - Kommentar: Initialize event bus widget.
        - 
        - Args:
        -     parent: Parent widget
      - def _subscribe_event(.)
        - Kommentar: Subscribe to an event and track for cleanup.
        - 
        - Args:
        -     event_type: Event type to subscribe to
        -     handler: Handler function
      - def _setup_event_subscriptions(.)
        - Kommentar: Set up event subscriptions.
        - 
        - Subclasses should override this method to subscribe to events
        - using _subscribe_event().
      - def closeEvent(.)
        - Kommentar: Clean up event subscriptions on close.
    - Class: BaseTableWidget
      - Kommentar: Base class for table-based widgets with common setup pattern.
      - 
      - Provides template method pattern for widget initialization:
      - 1. Create UI layout
      - 2. Create and configure table
      - 3. Add table to layout
      - 4. Set up event handlers
      - 
      - Subclasses should implement:
      - - _get_table_columns() - return list of column headers
      - - _configure_table() - optional additional table configuration
      - - _setup_event_subscriptions() - subscribe to events
      - def __init__(.)
        - Kommentar: Initialize base table widget.
        - 
        - Args:
        -     parent: Parent widget
      - def _init_ui(.)
        - Kommentar: Initialize UI using template method pattern.
      - def _get_table_columns(.)
        - Kommentar: Get table column headers.
        - 
        - Subclasses must implement this method.
        - 
        - Returns:
        -     List of column header labels
      - def _get_table_config(.)
        - Kommentar: Get table configuration parameters.
        - 
        - Subclasses can override to customize table behavior.
        - 
        - Returns:
        -     Dict of parameters for create_table_widget()
      - def _configure_table(.)
        - Kommentar: Configure table after creation.
        - 
        - Optional hook for subclasses to apply additional configuration.
      - def _add_additional_widgets(.)
        - Kommentar: Add additional widgets to layout.
        - 
        - Optional hook for subclasses to add widgets before/after table.
      - def update_row(.)
        - Kommentar: Update a table row with data.
        - 
        - Args:
        -     row: Row index
        -     data: Dictionary with column data
      - def _get_column_keys(.)
        - Kommentar: Get keys for mapping data to columns.
        - 
        - Subclasses should implement this to define how data dict keys
        - map to table columns.
        - 
        - Returns:
        -     List of keys matching column order
      - def _get_format_functions(.)
        - Kommentar: Get format functions for columns.
        - 
        - Subclasses can override to provide custom formatting.
        - 
        - Returns:
        -     Dict mapping column keys to format functions
    - def create_table_widget(.)
      - Kommentar: Create a configured QTableWidget with common settings.
      - 
      - Args:
      -     columns: List of column headers
      -     stretch_columns: If True, columns stretch to fill width
      -     selection_behavior: Row or cell selection
      -     selection_mode: Single, multi, or no selection
      -     editable: Allow editing cells
      -     alternating_colors: Use alternating row colors
      -     sortable: Enable column sorting
      - 
      - Returns:
      -     Configured QTableWidget
    - def setup_table_row(.)
      - Kommentar: Set up a table row with data.
      - 
      - Args:
      -     table: QTableWidget to update
      -     row: Row index
      -     data: Dictionary with data for the row
      -     column_keys: List of keys matching column order
      -     format_funcs: Optional dict mapping column keys to format functions
    - def create_vbox_layout(.)
      - Kommentar: Create a QVBoxLayout with common settings.
      - 
      - Args:
      -     parent: Parent widget (can be None)
      -     spacing: Spacing between widgets
      -     margins: Tuple of (left, top, right, bottom) margins. None for default.
      - 
      - Returns:
      -     Configured QVBoxLayout
    - def create_hbox_layout(.)
      - Kommentar: Create a QHBoxLayout with common settings.
      - 
      - Args:
      -     parent: Parent widget (can be None)
      -     spacing: Spacing between widgets
      -     margins: Tuple of (left, top, right, bottom) margins. None for default.
      - 
      - Returns:
      -     Configured QHBoxLayout
    - def create_grid_layout(.)
      - Kommentar: Create a QGridLayout with common settings.
      - 
      - Args:
      -     parent: Parent widget (can be None)
      -     spacing: Spacing between widgets
      -     margins: Tuple of (left, top, right, bottom) margins. None for default.
      - 
      - Returns:
      -     Configured QGridLayout
  - start_orderpilot.py
    - def setup_logging(.)
      - Kommentar: Setup application logging
    - def check_dependencies(.)
      - Kommentar: Check if all required dependencies are installed
    - def check_database(.)
      - Kommentar: Check and initialize database if needed
    - def print_startup_banner(.)
      - Kommentar: Display startup banner
    - def main_with_args(.)
      - Kommentar: Main function with argument handling
    - def create_parser(.)
      - Kommentar: Create command line argument parser
    - def main(.)
      - Kommentar: Main entry point
    - Kommentar: !/usr/bin/env python
    - Kommentar: Add src directory to path
  - Andere Dateien
    - requirements.txt
  - Kommentar: !/usr/bin/env python
  - Kommentar: Add src directory to path
  - Kommentar: Import and run the full-featured launcher
TREE-->