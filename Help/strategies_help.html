<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strategie Konfiguration - Hilfe | OrderPilot-AI</title>
    <style>
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --bg-highlight: #1a1a2e;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --accent-green: #26a69a;
            --accent-red: #ef5350;
            --accent-orange: #ff9800;
            --accent-blue: #2196f3;
            --accent-purple: #9c27b0;
            --border-color: #30363d;
            --link-color: #58a6ff;
            --code-bg: #0d1117;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        h1, h2, h3 {
            color: var(--text-primary);
            margin-bottom: 15px;
        }

        h1 { margin-bottom: 30px; border-bottom: 2px solid var(--border-color); padding-bottom: 10px; }
        h2 { margin-top: 40px; color: var(--accent-blue); }
        h3 { margin-top: 25px; color: var(--accent-purple); }

        p { margin-bottom: 15px; color: var(--text-secondary); }
        
        ul { margin-bottom: 15px; padding-left: 25px; color: var(--text-secondary); }
        li { margin-bottom: 8px; }

        code {
            font-family: 'Consolas', 'Monaco', monospace;
            background-color: rgba(110, 118, 129, 0.4);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
            color: var(--accent-orange);
        }

        pre {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 16px;
            overflow-x: auto;
            margin-bottom: 20px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
            color: var(--text-primary);
            display: block;
        }

        .note {
            background-color: rgba(33, 150, 243, 0.1);
            border-left: 4px solid var(--accent-blue);
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 0 4px 4px 0;
        }

        .warning {
            background-color: rgba(239, 83, 80, 0.1);
            border-left: 4px solid var(--accent-red);
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 0 4px 4px 0;
        }

        .table-container {
            overflow-x: auto;
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            font-weight: 600;
        }

        td { color: var(--text-secondary); }

        .tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        .tag.req { background-color: rgba(239, 83, 80, 0.2); color: var(--accent-red); }
        .tag.opt { background-color: rgba(38, 166, 154, 0.2); color: var(--accent-green); }

    </style>
</head>
<body>

    <div class="container">
        <h1>Strategie-Konfiguration (JSON)</h1>
        
        <p>
            OrderPilot-AI nutzt jetzt ein <strong>vollst√§ndig dateibasiertes Strategie-System</strong>. 
            Alle Strategien liegen als <code>.json</code> Dateien im Ordner <code>config/strategies/</code>.
        </p>
        
        <div class="note">
            <strong>üöÄ Vorteil:</strong> Sie k√∂nnen Strategien kopieren, umbenennen und Parameter anpassen, ohne den Programmcode neu starten zu m√ºssen.
            Der Bot l√§dt die Strategien beim Start automatisch.
        </div>

        <h2>üìÇ Dateistruktur</h2>
        <p>Jede Datei (z. B. <code>trend_following.json</code>) muss folgendes Grundger√ºst haben:</p>
        
        <pre><code>{
  "profile": { ... },       // Name, Beschreibung, Marktphasen
  "strategy_type": "...",   // Typ (trend_following, mean_reversion, etc.)
  "entry_rules": [ ... ],   // Liste der Einstiegsregeln
  "exit_rules": [ ... ],    // Liste der Ausstiegsregeln
  "trailing_mode": "...",   // Trailing Stop Modus (atr, pct, swing)
  "trailing_params": { ... } // Parameter f√ºr den Trailing Stop
}</code></pre>

        <h2>1. Profil & Metadaten</h2>
        <p>Hier definieren Sie, wann die Strategie aktiv sein darf.</p>
        <table>
            <thead><tr><th>Feld</th><th>Typ</th><th>Beschreibung</th></tr></thead>
            <tbody>
                <tr><td><code>name</code> <span class="tag req">Pflicht</span></td><td>String</td><td>Eindeutiger interner Name (z.B. "my_custom_v1")</td></tr>
                <tr><td><code>description</code></td><td>String</td><td>Angezeigter Text in der UI</td></tr>
                <tr><td><code>regimes</code></td><td>Liste</td><td>Erlaubte Marktphasen: <code>trend_up</code>, <code>trend_down</code>, <code>range</code></td></tr>
                <tr><td><code>volatility_levels</code></td><td>Liste</td><td>Erlaubte Vola: <code>low</code>, <code>normal</code>, <code>high</code></td></tr>
            </tbody>
        </table>

        <h2>2. Einstiegsregeln (Entry Rules)</h2>
        <p>Regeln definieren Bedingungen, die <strong>alle</strong> (oder je nach Logik gewichtet) erf√ºllt sein m√ºssen.</p>
        
        <pre><code>{
  "name": "rsi_low",
  "indicator": "rsi_14",
  "condition": "below",
  "threshold": 30.0,
  "weight": 1.5
}</code></pre>

        <h3>Verf√ºgbare Bedingungen (Conditions)</h3>
        <ul>
            <li><code>above</code> / <code>below</code>: Wert ist √ºber/unter Threshold.</li>
            <li><code>crosses_above</code> / <code>crosses_below</code>: Wert kreuzt Schwelle.</li>
            <li><code>between</code>: Wert zwischen <code>low</code> und <code>high</code> (in params).</li>
            <li><code>extreme</code>: Wert ist extrem (z.B. RSI &lt; 30 oder &gt; 70).</li>
            <li><code>direction_match</code>: Indikator zeigt in Trendrichtung.</li>
        </ul>

        <h2>3. Dynamische Logik & Variablen</h2>
        <p>
            Sie k√∂nnen in Zukunft dynamische Logik definieren. Aktuell unterst√ºtzte Variablen aus der "Trading Entered"-Tabelle:
        </p>
        
        <div class="warning">
            <strong>Hinweis:</strong> Die <em>direkte</em> Unterst√ºtzung f√ºr If/Else-Logik (z.B. "Wenn P&L > 0.5%") wird derzeit vom Bot-Core implementiert. 
            Sie k√∂nnen die Parameter hier eintragen, aber der Bot muss sie auch <em>lesen</em> k√∂nnen.
        </div>

        <h3>Beispiel: Gestaffelter Trailing-Stop (Geplant)</h3>
        <p>Um komplexe Trailing-Regeln abzubilden, nutzen Sie das <code>trailing_params</code> Objekt:</p>

        <pre><code>"trailing_params": {
  "mode": "stepped",
  "steps": [
    { "activation": 0.5, "distance": 0.2 },  // Ab 0.5% Gewinn -> 0.2% Abstand
    { "activation": 1.0, "distance": 0.1 }   // Ab 1.0% Gewinn -> 0.1% Abstand (enger)
  ]
}</code></pre>

        <h2>4. Validierung & Fehler</h2>
        <ul>
            <li><strong>JSON-Syntax:</strong> Die Datei muss valides JSON sein. Keine Kommas am Ende von Listen!</li>
            <li><strong>Unbekannte Felder:</strong> Werden ignoriert, solange die Pflichtfelder da sind.</li>
            <li><strong>Fehlende Pflichtfelder:</strong> Die Strategie wird beim Start mit ERROR im Log √ºbersprungen.</li>
        </ul>

        <h2>Beispiel: Komplette Datei</h2>
        <pre><code>{
  "profile": {
    "name": "simple_rsi_dip",
    "description": "Kauft wenn RSI < 30 in Aufw√§rtstrends",
    "regimes": ["trend_up"],
    "volatility_levels": ["normal"]
  },
  "strategy_type": "mean_reversion",
  "entry_rules": [
    {
      "name": "rsi_oversold",
      "indicator": "rsi_14",
      "condition": "below",
      "threshold": 30.0
    }
  ],
  "exit_rules": [
    {
      "name": "take_profit",
      "rule_type": "profit",
      "params": { "target_pct": 1.5 }
    }
  ],
  "stop_loss_pct": 2.0
}</code></pre>

    </div>
</body>
</html>