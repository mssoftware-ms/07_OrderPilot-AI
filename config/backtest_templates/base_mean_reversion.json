{
  "$schema": "../schemas/backtest_config_v2.schema.json",
  "version": "2.0.0",

  "meta": {
    "name": "Base Mean Reversion",
    "description": "Basis-Template fuer Mean-Reversion Strategien. Handelt Ruecksetzer zur Mittellinie in Range-Maerkten.",
    "author": "OrderPilot-AI",
    "tags": ["mean_reversion", "base", "range", "rsi", "oversold", "overbought"],
    "target_asset_class": "crypto",
    "target_timeframe": "15m",
    "scenario_type": "conservative"
  },

  "strategy_profile": {
    "type": "mean_reversion",
    "preset": "W0",
    "direction_bias": "BOTH"
  },

  "entry_score": {
    "weights": {
      "use_preset": "W0",
      "custom": null
    },
    "weight_presets": {
      "W0": { "trend": 0.25, "rsi": 0.15, "macd": 0.20, "adx": 0.15, "vol": 0.10, "volume": 0.15 },
      "W1": { "trend": 0.35, "rsi": 0.10, "macd": 0.15, "adx": 0.20, "vol": 0.10, "volume": 0.10 },
      "W2": { "trend": 0.25, "rsi": 0.20, "macd": 0.20, "adx": 0.10, "vol": 0.15, "volume": 0.10 },
      "W3_MR": { "trend": 0.15, "rsi": 0.30, "macd": 0.15, "adx": 0.10, "vol": 0.15, "volume": 0.15 }
    },
    "thresholds": {
      "min_score_for_entry": { "value": 0.55, "optimize": true, "range": [0.50, 0.55, 0.60, 0.65] }
    },
    "gates": {
      "block_in_chop": false,
      "block_against_strong_trend": true,
      "allow_counter_trend_sfp": true
    },
    "indicator_params": {
      "ema_short": 20,
      "ema_medium": 50,
      "ema_long": 200,
      "rsi_period": 14,
      "adx_strong_trend": 20.0
    }
  },

  "entry_triggers": {
    "breakout": {
      "enabled": false,
      "volume_multiplier": { "value": 1.5, "optimize": false },
      "close_threshold": { "value": 0.5, "optimize": false }
    },
    "pullback": {
      "enabled": true,
      "max_distance_atr": { "value": 1.5, "optimize": true, "range": [1.2, 1.5, 2.0] },
      "rejection_wick_pct": { "value": 0.4, "optimize": true, "range": [0.3, 0.4, 0.5] }
    },
    "sfp": {
      "enabled": true,
      "wick_body_ratio": { "value": 2.5, "optimize": true, "range": [2.0, 2.5, 3.0] },
      "penetration_pct": { "value": 0.35, "optimize": false }
    }
  },

  "exit_management": {
    "stop_loss": {
      "type": "atr_based",
      "atr_multiplier": { "value": 1.8, "optimize": true, "range": [1.5, 1.8, 2.2] },
      "percent": { "value": 1.0, "optimize": false }
    },
    "take_profit": {
      "type": "atr_based",
      "atr_multiplier": { "value": 1.5, "optimize": true, "range": [1.2, 1.5, 1.8] },
      "use_level": true
    },
    "trailing_stop": {
      "enabled": false,
      "move_to_breakeven": true,
      "activation_atr": { "value": 1.0, "optimize": false },
      "distance_atr": { "value": 0.6, "optimize": false },
      "step_percent": { "value": 0.2, "optimize": false }
    },
    "partial_tp": {
      "enabled": true,
      "tp1_percent": 60,
      "tp1_rr": 0.8
    },
    "time_stop": {
      "enabled": true,
      "max_holding_minutes": 240
    }
  },

  "risk_leverage": {
    "risk_per_trade_pct": { "value": 0.50, "optimize": true, "range": [0.25, 0.50, 0.75] },
    "base_leverage": { "value": 3, "optimize": true, "range": [2, 3, 5] },
    "max_leverage": 10,
    "min_liquidation_distance_pct": 8.0,
    "max_daily_loss_pct": 2.0,
    "max_trades_per_day": 8,
    "max_concurrent_positions": 1,
    "max_loss_streak": 3,
    "cooldown_after_streak_min": 90
  },

  "execution_simulation": {
    "initial_capital": 1000.0,
    "fee_maker_pct": 0.02,
    "fee_taker_pct": 0.06,
    "assume_taker": true,
    "slippage_method": "fixed_bps",
    "slippage_bps": 5.0,
    "funding_rate_8h": 0.01
  },

  "optimization": {
    "method": "grid",
    "max_iterations": 300,
    "target_metric": "profit_factor",
    "minimize": false,
    "n_jobs": -1,
    "seed": 42
  },

  "walk_forward": {
    "enabled": true,
    "train_window_days": 120,
    "test_window_days": 40,
    "step_size_days": 40,
    "min_folds": 3,
    "reoptimize_each_fold": true
  },

  "parameter_groups": [],

  "conditionals": [
    {
      "if": { "entry_score.indicator_params.adx_strong_trend": { "<": 20 } },
      "then": { "entry_score.gates.block_in_chop": false }
    }
  ],

  "constraints": {
    "min_trades": 40,
    "max_drawdown_pct": 20,
    "min_win_rate": 0.55,
    "min_profit_factor": 1.4,
    "min_sharpe": 0.7,
    "weights_must_sum_to_one": true
  }
}
