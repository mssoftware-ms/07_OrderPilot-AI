{
  "$schema": "../schemas/backtest_config_v2.schema.json",
  "version": "2.0.0",

  "meta": {
    "name": "Base Scalping",
    "description": "Basis-Template fuer Scalping Strategien. Schnelle Ein- und Ausstiege mit engem SL.",
    "author": "OrderPilot-AI",
    "tags": ["scalping", "base", "fast", "momentum"],
    "target_asset_class": "crypto",
    "target_timeframe": "1m",
    "scenario_type": "aggressive"
  },

  "strategy_profile": {
    "type": "scalping",
    "preset": "W2",
    "direction_bias": "BOTH"
  },

  "entry_score": {
    "weights": {
      "use_preset": "W2",
      "custom": null
    },
    "weight_presets": {
      "W0": { "trend": 0.25, "rsi": 0.15, "macd": 0.20, "adx": 0.15, "vol": 0.10, "volume": 0.15 },
      "W1": { "trend": 0.35, "rsi": 0.10, "macd": 0.15, "adx": 0.20, "vol": 0.10, "volume": 0.10 },
      "W2": { "trend": 0.25, "rsi": 0.20, "macd": 0.20, "adx": 0.10, "vol": 0.15, "volume": 0.10 }
    },
    "thresholds": {
      "min_score_for_entry": { "value": 0.50, "optimize": true, "range": [0.45, 0.50, 0.55, 0.60] }
    },
    "gates": {
      "block_in_chop": true,
      "block_against_strong_trend": true,
      "allow_counter_trend_sfp": true
    },
    "indicator_params": {
      "ema_short": 9,
      "ema_medium": 21,
      "ema_long": 200,
      "rsi_period": 7,
      "adx_strong_trend": 25.0
    }
  },

  "entry_triggers": {
    "breakout": {
      "enabled": true,
      "volume_multiplier": { "value": 1.3, "optimize": true, "range": [1.2, 1.5, 1.8] },
      "close_threshold": { "value": 0.4, "optimize": false }
    },
    "pullback": {
      "enabled": true,
      "max_distance_atr": { "value": 0.8, "optimize": true, "range": [0.6, 0.8, 1.0] },
      "rejection_wick_pct": { "value": 0.3, "optimize": false }
    },
    "sfp": {
      "enabled": true,
      "wick_body_ratio": { "value": 2.0, "optimize": true, "range": [1.5, 2.0, 2.5] },
      "penetration_pct": { "value": 0.3, "optimize": false }
    }
  },

  "exit_management": {
    "stop_loss": {
      "type": "atr_based",
      "atr_multiplier": { "value": 1.3, "optimize": true, "range": [1.0, 1.3, 1.6] },
      "percent": { "value": 0.5, "optimize": false }
    },
    "take_profit": {
      "type": "atr_based",
      "atr_multiplier": { "value": 1.8, "optimize": true, "range": [1.5, 1.8, 2.2] },
      "use_level": false
    },
    "trailing_stop": {
      "enabled": true,
      "move_to_breakeven": true,
      "activation_atr": { "value": 0.8, "optimize": true, "range": [0.6, 0.8, 1.0] },
      "distance_atr": { "value": 0.5, "optimize": true, "range": [0.4, 0.5, 0.7] },
      "step_percent": { "value": 0.15, "optimize": false }
    },
    "partial_tp": {
      "enabled": true,
      "tp1_percent": 50,
      "tp1_rr": 1.0
    },
    "time_stop": {
      "enabled": true,
      "max_holding_minutes": 120
    }
  },

  "risk_leverage": {
    "risk_per_trade_pct": { "value": 0.50, "optimize": true, "range": [0.25, 0.50, 0.75] },
    "base_leverage": { "value": 10, "optimize": true, "range": [5, 8, 10, 15] },
    "max_leverage": 25,
    "min_liquidation_distance_pct": 4.0,
    "max_daily_loss_pct": 3.0,
    "max_trades_per_day": 20,
    "max_concurrent_positions": 1,
    "max_loss_streak": 4,
    "cooldown_after_streak_min": 30
  },

  "execution_simulation": {
    "initial_capital": 500.0,
    "fee_maker_pct": 0.02,
    "fee_taker_pct": 0.06,
    "assume_taker": true,
    "slippage_method": "fixed_bps",
    "slippage_bps": 5.0,
    "funding_rate_8h": 0.01
  },

  "optimization": {
    "method": "random",
    "max_iterations": 400,
    "target_metric": "expectancy",
    "minimize": false,
    "n_jobs": -1,
    "seed": 42
  },

  "walk_forward": {
    "enabled": true,
    "train_window_days": 60,
    "test_window_days": 20,
    "step_size_days": 20,
    "min_folds": 4,
    "reoptimize_each_fold": true
  },

  "parameter_groups": [],

  "conditionals": [
    {
      "if": { "risk_leverage.base_leverage": { ">=": 15 } },
      "then": { "risk_leverage.min_liquidation_distance_pct": 6.0 }
    },
    {
      "if": { "strategy_profile.type": "scalping" },
      "then": {
        "exit_management.time_stop.enabled": true,
        "exit_management.time_stop.max_holding_minutes": 120
      }
    }
  ],

  "constraints": {
    "min_trades": 80,
    "max_drawdown_pct": 25,
    "min_win_rate": 0.50,
    "min_profit_factor": 1.3,
    "min_sharpe": 0.6,
    "weights_must_sum_to_one": true
  }
}
